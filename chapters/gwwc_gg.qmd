---
execute:
    freeze: auto # re-render only when source changes
    warning: false
    message: false
    error: true
---

# Giving What We Can: Giving guides {#gwwc_gg}

## The trial


> our Effective Giving Guide Lead Generation campaign ... ran late November 2021 - January 2022. The objective of this campaign was to see whether a factual or cause led approach was more cost effective at getting people to fill out a form and give us their email in order to download our Effective Giving Guide.

> In the original version of our test, we had 1 video for the factual appeal and 3 videos for the cause led approach - 1 for global health and development, 1 for animal welfare and 1 for climate change.

> We targeted our ads to audiences we thought were likely to engage based on their interests and demographics, and targeted the cause led videos to a relevant audience, i.e. climate change message to climate change audience.

> We also had various text above the videos that were displayed and optimised too.


```{r, include=FALSE}
library(here)
source(here("code", "shared_packages_code.R"))
```


Details in Gitbook [HERE](https://effective-giving-marketing.gitbook.io/untitled/partner-organizations-and-trials/gwwc/giving-guides-+) and Gdoc [here](https://docs.google.com/document/d/1FfrXhD1YAIjrATy9PR6ScP20NMQa82sd80YvMb62iUQ/edit)

```{r wppage}

knitr::include_url("https://effective-giving-marketing.gitbook.io/untitled/partner-organizations-and-trials/gwwc/giving-guides-+s")

```


## Build: Source data input and cleaning code

**Update:** The discussion below does not pertain to the actual raw data. The actual original/raw data is collapsed (breakdowns) by demography and ad set, into 2 files:


`video breakdown.csv`

`text breakdown.csv`


That data is clearly not identifying individuals; it involves aggregates based on real or assumed characteristics ... and, as the other data is derived from it, there is clearly nothing that needs to be hidden there


::: {.callout-note collapse="true"}
## Access to data

Note: You must have access to the gwwc raw data to run this. This includes data that was constructed (with what code?) by expanding Facebook's aggregate reporting.

The files:

textdata_dv_linkclicks.csv
videodata_dv_results.csv
textdata_dv_results.csv
videodata_dv_linkclicks.csv

are gitignored because of size
:::


```{r input_build_gwwc_gg_data}

raw_data_path <- list("gwwc", "gg_raw_data_shareable")

source(here("gwwc", "giving_guides", "input_build_gwwc_gg_data_results.R"))

#source(here("gwwc", "giving_guides", "input_build_gwwc_gg_data_clicks.R"))

```

The code above inputs and builds 2-4 related data frames (tibbles), which were constructed from the collapsed (aggregated) data

`gwwc_text_clicks`: Observations of link clicks ...  by texts above video
`gwwc_vid_clicks`:  ...  by video content

(I ignore the 'click data' results for now because I don't think it is particularly meaningful.)

`gwwc_text_results`: Observations of emails provided ... by texts above video
`gwwc_vid_results`: ...  by video content



## Asking and answering questions 

::: {.callout-note collapse="true"}
## This dynamic document format allows us to ask and answer a series of questions 

- Using the data, with all coding steps shown
- Ideally, following a pre-defined (pre-analysis) plan
- Using the data and statistics directly and automatically in the narrative
     - And everything will be automatically adjusted if we bring in new data or adjust/correct features

::: 

## Analysis and visuals (moved from Erin's work)


```{r}

#summary(gwwc_vid_results$DV_costadj)
#summary(gwwc_vid_results$DV)
#summary(gwwc_vid_results$ave.cost.impr)

```

Data summary

```{r}

gwwc_vid_results %>% group_by(Age) %>% summarise(n=n())
gwwc_vid_results %>% group_by(Gender) %>% summarise(n=n())
print(gwwc_vid_results %>% group_by(Gender,Age) %>% summarise(n=n(),cost=mean(ave.cost.impr)),n=40)
print(gwwc_vid_results %>% group_by(Ad.Set.Name) %>% summarise(n=n(),cost=mean(ave.cost.impr)),n=41)
print(gwwc_vid_results %>% group_by(Campaign.name,Ad.Set.Name) %>% summarise(n=n(),cost=mean(ave.cost.impr)),n=100)
gwwc_vid_results %>% group_by(audience) %>% summarise(n=n(),cost=mean(ave.cost.impr)*100)
gwwc_vid_results %>% group_by(message) %>% summarise(n=n(),cost=mean(ave.cost.impr)*100)

```



###Â CHART DATA

```{r}

print(gwwc_vid_results %>% group_by(audience,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n=50)


```


## PLOTS


```{r common_plot_options}

#Plot options in common

limits <- aes(ymax = mean_dv + (se_dv), ymin = mean_dv - (se_dv))
dodge <- position_dodge(width = 0.9)

vid_types <-
  c("factual short",
    "animal",
    "climate",
    "factual long",
    "hypercube",
    "poverty")

gg_gg_options <- list(geom_bar(stat = 'identity', position=dodge),
  geom_errorbar(limits, position=dodge,  width=0.05),
  jtools::theme_apa(),
  theme(legend.position="none"),
  geom_text(aes(label = paste("$",mean_dv %>% round(.,2)), y=5), position = position_dodge(.9), size=4, color="white"),
  theme(text=element_text(size=10))
)

grpsumgg <- function(df, gvar, var) {
  df %>%
  group_by({{gvar}}) %>%
  summarise(mean_dv = mean({{var}}, na.rm=TRUE),
            se_dv = sd({{var}}, na.rm=TRUE)/sqrt(n())) 
}


```

### PLOT: Cost adjusted DV (results) by video


```{r}

print(gwwc_vid_results %>% filter(ave.cost.impr>0) %>% group_by(media) %>% summarise(results=mean(DV_costadj),SE=std.error(DV_costadj),n=n()),n=50)


gwwc_vid_results %>%
  grpsumgg(media, DV_costadj) %>%
  ggplot(aes(x=media, y=mean_dv)) +
  gg_gg_options +
  geom_bar(stat='identity',fill="#0072B2", position=dodge) +
  ylab('Results/$ spent') +
  xlab('Video') +
  ggtitle('Results/$ spent by Video') +
  scale_y_continuous(limits = c(0,.2),  breaks=seq(0,.2, by=.05)) +
  scale_x_discrete(labels=vid_types)


```

### PLOT: DV (Results) by video


```{r}
print(gwwc_vid_results %>% filter(ave.cost.impr>0) %>% group_by(media) %>% summarise(results=100*mean(DV),SE=100*std.error(DV),n=n()),n=50)

gwwc_vid_results %>%
   grpsumgg(media, DV) %>%
  ggplot(aes(x=media, y=mean_dv)) +
  geom_bar(stat='identity', fill="#0072B2",position=dodge) +
  ylab('Results (%)')+
  xlab('Video')+
  ggtitle('Results by Video')+
  scale_x_discrete(labels=vid_types)



```

### PLOT: Cost adjusted DV (results) by video and audience


Questions/Notes: Removed the retargeting audience

```{r}

print(gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>% group_by(media,audience) %>% summarise(results=mean(DV_costadj),SE=std.error(DV_costadj),n=n()),n=50)


gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>%
  group_by(media, audience) %>%
  summarise(mean_dv = mean(DV_costadj, na.rm=TRUE),
            se_dv = sd(DV_costadj, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=audience, y=mean_dv, group=media, fill=media)) +
  gg_gg_options +
  labs(fill="Video")+
  scale_fill_brewer(palette="RdBu")+
  ylab('Results/$ spent')+
  xlab('Audience')+
  ggtitle('Results/$ spent by Video and Audience')+
  theme_apa(legend.font.size = 8,legend.use.title = TRUE)+
  scale_y_continuous(limits = c(0,.25), oob = rescale_none, breaks=seq(0,.75, by=.25)) +
  scale_x_discrete(labels=c("philanthropy","animal","climate","general","lookalike","poverty","retargeting"))

levels(gwwc_vid_results$audience)


```

### PLOT: DV (results) by video and audience

Questions/Notes: Removed the retargeting audience


```{r}
print(gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>% group_by(media,audience) %>% summarise(results=100*mean(DV),SE=100*std.error(DV),n=n()),n=50)


gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>%
  group_by(media, audience) %>%
  summarise(mean_dv = 100*mean(DV, na.rm=TRUE),
            se_dv = 100*sd(DV, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=audience, y=mean_dv, group=media, fill=media)) +
  gg_gg_options +
  labs(fill="Video")+
  scale_fill_brewer(palette="RdBu")+
  ylab('Results (%)')+
  xlab('Audience')+
  ggtitle('Results by Video and Audience')+
  theme_apa(legend.font.size = 8,legend.use.title = TRUE)+
  scale_y_continuous(limits = c(0,1.1),  oob = rescale_none,  breaks=seq(0,1.1, by=.1)) +
  scale_x_discrete(labels=c("philanthropy","animal","climate","general","lookalike","poverty","retargeting"))




```

### PLOT: Cost adjusted DV (results) by audience


```{r}
print(gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>% group_by(audience) %>% summarise(results=mean(DV_costadj),SE=std.error(DV_costadj),n=n()),n=50)

```

```{r}

gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>%
  group_by(audience) %>%
summarise(mean_dv = mean(DV_costadj, na.rm=TRUE),
            se_dv = sd(DV_costadj, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=audience, y=mean_dv)) +
  gg_gg_options +
  ylab('Results/$ spent')+
  xlab('Audience')+
  ggtitle('Results/$ spent by Audience')+
  scale_y_continuous(limits = c(0,.2),  breaks=seq(0,.2, by=.05)) +
  scale_x_discrete(labels=c("philanthropy","animal"   ,"climate","general","lookalike","poverty"))


```



### PLOT: DV (Results) by audience


```{r}
print(gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>% group_by(audience) %>% summarise(results=100*mean(DV),SE=100*std.error(DV),n=n()),n=50)


gwwc_vid_results %>% filter(ave.cost.impr>0 & audience !="retargeting") %>%
  group_by(audience) %>%
  summarise(mean_dv = 100*mean(DV, na.rm=TRUE),
            se_dv = 100*sd(DV, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=audience, y=mean_dv)) +
  gg_gg_options +
  ylab('Results (%)')+
  xlab('Audience')+
  ggtitle('Results by Audience')+
  scale_y_continuous(limits = c(0,.4),  breaks=seq(0,.4, by=.05)) +
  scale_x_discrete(labels=c("philanthropy","animal"   ,"climate","general","lookalike","poverty"))

```

### PLOT: Cost adjusted DV (results) by age and gender
Did not filter out the retargeting audience like i did for the other charts


```{r}
gwwc_vid_results$Gender <- as.factor(gwwc_vid_results$Gender)
levels(gwwc_vid_results$Gender)

class(gwwc_vid_results$Age)
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="18-24")
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="13-17")
levels(gwwc_vid_results$Age)

print(gwwc_vid_results %>% filter(ave.cost.impr>0) %>% group_by(Age,Gender) %>% summarise(results=mean(DV_costadj),SE=std.error(DV_costadj),n=n()),n=50)


gwwc_vid_results %>% filter(ave.cost.impr>0 & Age!="13-17") %>%
  group_by(Age, Gender) %>%
  summarise(mean_dv = mean(DV_costadj, na.rm=TRUE),
            se_dv = sd(DV_costadj, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=Age, y=mean_dv, group=Gender, fill=Gender)) +
  gg_gg_options +
  labs(fill="Gender")+
  scale_fill_brewer(palette="Paired")+
  ylab('Results/$ spent')+
  xlab('Age')+
  ggtitle('Results/$ spent by Age and Gender')+
  theme_apa(legend.font.size = 8,legend.use.title = TRUE)+
  scale_y_continuous(limits = c(0,.35),  breaks=seq(0,.35, by=.1)) +
  scale_x_discrete(labels=c("18-24","25-34","35-44","45-54","55-64","65+" ))

```

### PLOT: DV (results) by age and gender


```{r}
gwwc_vid_results$Gender <- as.factor(gwwc_vid_results$Gender)
levels(gwwc_vid_results$Gender)

class(gwwc_vid_results$Age)
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="18-24")
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="13-17")
levels(gwwc_vid_results$Age)

print(gwwc_vid_results %>% filter(ave.cost.impr>0) %>% group_by(Age,Gender) %>% summarise(results=100*mean(DV),SE=std.error(100*DV),n=n()),n=50)


gwwc_vid_results %>% filter(ave.cost.impr>0 & Age!="13-17") %>%
  group_by(Age, Gender) %>%
  summarise(mean_dv = 100*mean(DV, na.rm=TRUE),
            se_dv = 100*sd(DV, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=Age, y=mean_dv, group=Gender, fill=Gender)) +
  gg_gg_options +
  labs(fill="Gender")+
  scale_fill_brewer(palette="Paired")+
  ylab('Results (%)')+
  xlab('Age')+
  ggtitle('Results by Age and Gender')+
  theme_apa(legend.font.size = 8,legend.use.title = TRUE)+
  scale_y_continuous(limits = c(0,.75),  breaks=seq(0,.75, by=.25)) +
  scale_x_discrete(labels=c("18-24","25-34","35-44","45-54","55-64","65+" ))

```

### PLOT: Cost adjusted DV (results) by Video and Age #####


```{r}
class(gwwc_vid_results$Age)
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="18-24")
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="13-17")
levels(gwwc_vid_results$Age)

print(gwwc_vid_results %>% filter(ave.cost.impr>0) %>% group_by(Age,media) %>% summarise(results=mean(DV_costadj),SE=std.error(DV_costadj),n=n()),n=50)


gwwc_vid_results %>% filter(ave.cost.impr>0 & Age!="13-17") %>%
  group_by(media, Age) %>%
  summarise(mean_dv = mean(DV_costadj, na.rm=TRUE),
            se_dv = sd(DV_costadj, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=Age, y=mean_dv, group=media, fill=media)) +
  gg_gg_options +
  labs(fill="Video")+
  scale_fill_brewer(palette="RdBu")+
  ylab('Results/$ spent')+
  xlab('Age')+
  ggtitle('Results/$ spent by Video and Age')+
  theme_apa(legend.font.size = 8,legend.use.title = TRUE)+
  scale_y_continuous(limits = c(0,.2),  breaks=seq(0,.2, by=.05)) +
  scale_x_discrete(labels=c("18-24","25-34","35-44","45-54","55-64","65+"))


```

### PLOT: DV (results) by video and age


```{r}
class(gwwc_vid_results$Age)
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="18-24")
gwwc_vid_results$Age <- relevel(gwwc_vid_results$Age, ref="13-17")
levels(gwwc_vid_results$Age)

print(gwwc_vid_results %>% filter(ave.cost.impr>0) %>% group_by(Age,media) %>% summarise(results=100*mean(DV),SE=100*std.error(DV),n=n()),n=50)

```


```{r}



gwwc_vid_results %>% filter(ave.cost.impr>0 & Age !="13-17") %>%
    group_by(media, Age) %>%
  summarise(mean_dv = 100*mean(DV, na.rm=TRUE),
            se_dv = 100*sd(DV, na.rm=TRUE)/sqrt(n())) %>%
  ggplot(aes(x=Age, y=mean_dv, group=media, fill=media)) +
  gg_gg_options +
  labs(fill="Video")+
  scale_fill_brewer(palette="RdBu")+
  ylab('Results (%)')+
  xlab('Age')+
  ggtitle('Results by Video and Age')+
  theme_apa(legend.font.size = 8,legend.use.title = TRUE)+
  scale_y_continuous(limits = c(0,.85),  breaks=seq(0,.85, by=.25)) +
  scale_x_discrete(labels=c("18-24","25-34","35-44","45-54","55-64","65+"))


```

## Statistics and mi-- needs to be made into table


### Regressions with interactions

```{r}
summary(lm(data = gwwc_vid_results, DV~Gender*Age+ave.cost.impr))
summary(lm(data = gwwc_vid_results,DV~Gender*Age))


```


### Regressions with no interactions

just demographics, not control



```{r}
summary(data = lm(gwwc_vid_results,DV~Gender+Age))
```


just demographic, controlling for cost

```{r}
summary(lm(gwwc_vid_results,DV~Gender+Age+ave.cost.impr))

```

means and standard errors for age groups/gender

```{r}
print(gwwc_vid_results %>% group_by(Gender,Age) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n=50)
```



```{r}

hist(gwwc_vid_results$DV_costadj[gwwc_vid_results$DV_costadj>0])
hist(gwwc_vid_results$DV_costadj[gwwc_vid_results$DV_costadj>=0])
```


### DEMOGRAPHICS WITH CONTROLS FOR VIDEO AND COST ####

```{r}


summary(lm(gwwc_vid_results,DV~Gender+Age+ave.cost.impr))
summary(lm(gwwc_vid_results, DV_costadj~Gender+Age))
```


#### AUDIENCES ####

main effects

```{r}
summary(lm(gwwc_vid_results,DV~Gender+Age+ave.cost.impr+audience))
```

NEW DV

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender+Age+audience))

  #interactions
  summary(lm(gwwc_vid_results,DV~Gender*audience+ave.cost.impr+Age))

## NEW DV
    summary(lm(gwwc_vid_results,DV_costadj~Gender*audience+Age))
  summary(lm(gwwc_vid_results,DV~Age*audience+ave.cost.impr+Gender))

  #means for audience
  print(gwwc_vid_results %>% group_by(audience) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n=50)

```

#### MESSAGES ####

no controls

```{r}
summary(lm(gwwc_vid_results,DV~message))
  #control for cost only
  summary(lm(gwwc_vid_results,DV~message+ave.cost.impr))
  #check results with campaign
  summary(lm(gwwc_vid_results,DV~Campaign.name))
  #check results with campaign and cost control
  summary(lm(gwwc_vid_results,DV~Campaign.name+ave.cost.impr))
```

with controls

```{r}
summary(lm(gwwc_vid_results,DV~Gender+Age+ave.cost.impr+audience+message))

  #interactions
  #with audience
  summary(lm(gwwc_vid_results,DV~message*audience+ave.cost.impr+Age+Gender))
  #with Gender
  summary(lm(gwwc_vid_results,DV~message*Gender+ave.cost.impr+Age+audience))
  #with Age (emotional much worse with ages 65+)
  summary(lm(gwwc_vid_results,DV~message*Age+ave.cost.impr+Age+audience))

```

interaction with age and campaign restriction

```{r}

summary(lm(gwwc_vid_results,DV~message*agetrin+message*restriction18_39+ave.cost.impr+Age+Gender))
summary(lm(gwwc_vid_results,DV~message*agetrin+message*restriction18_39+ave.cost.impr))


```

in just early campaigns

```{r}
summary(lm(subset(data,restriction18_39==0),DV~message*agetrin+ave.cost.impr))



```


### MEDIA


no controls

```{r}
summary(lm(gwwc_vid_results,DV~media))

```

means and SEs

```{r}
gwwc_vid_results %>% group_by(media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results)

```

control for cost only

```{r}
summary(lm(gwwc_vid_results,DV~media+ave.cost.impr))
```

## NEW DV

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media))####THIS IS GOOD?

```

with controls

```{r}
summary(lm(gwwc_vid_results,DV~Gender+Age+ave.cost.impr+audience+media))
```

### NEW DV

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender+Age+audience+media))

```

interactions

```{r}
summary(lm(gwwc_vid_results,DV~media*Age+media*Gender+media*audience+ave.cost.impr))
summary(lm(gwwc_vid_results,DV_costadj~media*Age+media*Gender+media*audience))
summary(lm(gwwc_vid_results,DV~media*Age+media*Gender+media*audience))
summary(lm(gwwc_vid_results,DV_costadj~Age+Gender+media*audience))

```

with audience

```{r}
summary(lm(gwwc_vid_results,DV~media*audience+ave.cost.impr+Age+Gender))
```

means and SEs

```{r}
print(gwwc_vid_results %>% group_by(audience,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n=50)

print(gwwc_vid_results %>% filter(gwwc_vid_results$ave.cost.impr>0) %>% group_by(audience,media) %>% summarise(results=mean(DV_costadj),SE=std.error(DV_costadj),n=n()),n=50)

```

NEW DV with audience

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media*audience+Age+Gender))
```

means and SEs

```{r}
print(gwwc_vid_results %>% group_by(audience,media) %>% summarise(results=mean(DV_costadj)*100,SE=std.error(DV_costadj)*100,n=n()),n=50)

```

with Gender

```{r}
summary(lm(gwwc_vid_results,DV~media*Gender+ave.cost.impr+Age+audience))
```

means and SEs
gwwc_vid_results %>% group_by(Gender,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results)


with Age (emotional much worse with ages 65+)
summary(lm(gwwc_vid_results,DV~media*Age+ave.cost.impr+Age+audience))


means and SEs
print(gwwc_vid_results %>% group_by(Age,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n = 50)
print(gwwc_vid_results %>% group_by(audience,Age,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n = 500)


interaction with age and campaign restriction - old people really hated factual long

```{r}
summary(lm(gwwc_vid_results,DV~media*agetrin+media*restriction18_39+ave.cost.impr+Age+Gender))
summary(lm(gwwc_vid_results,DV~media*agetrin+media*restriction18_39+ave.cost.impr))
```

in just early campaigns

```{r}
summary(subset(gwwc_vid_results,restriction18_39==0),DV~media*agetrin+ave.cost.impr))
```

means and SEs

```{r}
gwwc_vid_results %>% filter(restriction18_39==0) %>% group_by(Age,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results)


```


# DEMOGRPAHICS AND COST ONLY ####
regressions with interactions

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender*Age)) #no significant effects

```

regressions with no interactions
just demographic, not control

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender+Age))

```

means and standard errors for age groups/gender

```{r}
print(gwwc_vid_results %>% group_by(Gender,Age) %>% summarise(results=mean(DV_costadj)*100,SE=std.error(DV_costadj)*100,n=n()),n=50) ##idk if the changes i made to this line make sense


```

#### DEMOGRAPHICS WITH CONTROLS FOR VIDEO ####


```{r}
summary(gwwc_vid_results %>% lm(data = ., DV_costadj~Gender+Age+Video))

```

#### AUDIENCES ####

main effects

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender+Age+audience))

```

interactions

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender*audience+Age))
summary(lm(gwwc_vid_results,DV_costadj~Age*audience+Gender))

```

means for audience

```{r}
print(gwwc_vid_results %>% group_by(audience) %>% summarise(results=mean(DV_costadj)*100,SE=std.error(DV_costadj)*100,n=n()),n=50) #Why all NaN?



```

#### MESSAGES ####

no controls

```{r}
summary(lm(gwwc_vid_results,DV_costadj~message))
summary(lm(gwwc_vid_results,DV~message+ave.cost.impr))
```

check results with campaign

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Campaign.name))
```

with controls

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender+Age+audience+message))

```

interactions
with audience

```{r}
summary(lm(gwwc_vid_results,DV_costadj~message*audience+Age+Gender))
```

with Gender

```{r}
summary(lm(gwwc_vid_results,DV_costadj~message*Gender+Age+audience))
```

with Age (emotional much worse with ages 65+)

```{r}
summary(lm(gwwc_vid_results,DV_costadj~message*Age+Age+audience))

```

interaction with age and campaign restriction

```{r}
summary(lm(gwwc_vid_results,DV_costadj~message*agetrin+message*restriction18_39+Age+Gender))
summary(lm(gwwc_vid_results,DV_costadj~message*agetrin+message*restriction18_39))
```

in just early campaigns

```{r}
summary(lm(subset(gwwc_vid_results,restriction18_39==0),DV_costadj~message*agetrin))

```

#### MEDIA ####
no controls

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media))

```

means and SEs

```{r}
data %>% filter(ave.cost.impr > 0) %>% group_by(media) %>% summarise(mean(DV_costadj),results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results, RPC = results/cost) ##idk how to do this line?

```

with controls

```{r}
summary(lm(gwwc_vid_results,DV_costadj~Gender+Age+audience+media))

```

interactions

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media*Age+media*Gender+media*audience))

```

with audience

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media*audience+Age+Gender))

```

means and SEs

```{r}
print(data %>% group_by(audience,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n=50) ###skipped updating

```

with Gender

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media*Gender+Age+audience))
```

means and SEs

```{r}
data %>% group_by(Gender,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results) #####skipped updating


```

with Age (emotional much worse with ages 65+)

don't see the effect of emotional being much worse with ages 65+

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media*Age+Age+audience))


`#means and SEs

```{r}
print(data %>% group_by(Age,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n = 50) ###idk how to update this
print(data %>% group_by(audience,Age,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results),n = 500) ###idk how to update this


interaction with age and campaign restriction - old people really hated factual long

```{r}
summary(lm(gwwc_vid_results,DV_costadj~media*agetrin+media*restriction18_39+Age+Gender))
summary(lm(gwwc_vid_results,DV_costadj~media*agetrin+media*restriction18_39))
```

in just early campaigns

```{r}
summary(lm(gwwc_vid_results=subset(gwwc_vid_results,restriction18_39==0),DV_costadj~media*agetrin))
```

means and SEs

```{r}
gwwc_vid_results %>% filter(restriction18_39==0) %>% group_by(Age,media) %>% summarise(results=mean(DV)*100,SE=std.error(DV)*100,n=n(),cost=mean(ave.cost.impr),CPR=cost/results)



```


