<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="1 OftW pre-giving-tuesday-email upselling split test (considering ‘impact vs emotion’) | EA Market testing data analysis" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Description and analysis of EAMT trials" />
<meta name="github-repo" content="daaronr/eamt_data_analysis" />

<meta name="author" content="David Reinstein and other members of the EAMT team" />



<meta name="description" content="Description and analysis of EAMT trials">

<title>1 OftW pre-giving-tuesday-email upselling split test (considering ‘impact vs emotion’) | EA Market testing data analysis</title>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style>
  
:root {
  --sidebar-width: 350px;
  --primary-color: #43718f;
}

#wrapper {
  overflow: hidden;
  height: 100vh;
}

@supports (-webkit-touch-callout: none) {
  #wrapper {
    height: -webkit-fill-available;
  }
}

/* Main */

#main-container {
  height: calc(100% - 57px);
  overflow-y: auto;
}

main {
  max-width: 800px;
  margin: 0 auto;
}

main h1, main h2 {
  padding-top: 1rem;
}

/* Sidebar */

#sidebar-wrapper {
  margin-left: calc(var(--sidebar-width) * -1);
  transition: margin 0.25s ease-out;
}

#sidebar-wrapper .list-group {
  width: var(--sidebar-width);
}

#sidebar-wrapper .list-group-flush > .list-group-item:last-child {
  border-bottom-width: 1px;
}

#sidebar-wrapper .list-group {
  width: var(--sidebar-width);
}

#sidebar-wrapper .list-subgroup a {
  margin-left: 1rem;
}

.list-group-item.active {
  background-color: var(--primary-color);
  border-color: var(--primary-color);;
}

#page-content-wrapper {
  min-width: 100vw;
}

body.sb-sidenav-toggled #wrapper #sidebar-wrapper {
  margin-left: 0;
}

@media (min-width: 768px) {
  #sidebar-wrapper {
    margin-left: 0;
  }

  #page-content-wrapper {
    min-width: 0;
    width: 100%;
  }

  body.sb-sidenav-toggled #wrapper #sidebar-wrapper {
    margin-left: calc(var(--sidebar-width) * -1);
  }
}

#sidebar-heading {
  display: flex;
  height: 57px;
  width: var(--sidebar-width);
  padding: 0.875rem 1.25rem;
  font-size: 1.2rem;
}

#sidebar-heading img {
  margin-right: 0.5rem;
}

/* TOC */

#TOC {
  height: calc(100% - 57px);
  overflow-y: auto;
  overflow-x: hidden;
  font-size: 0.9rem;
}

#TOC a {
  display: flex;
}

#TOC a:hover {
  color: var(--primary-color);
}

#TOC .active:hover {
  color: #fff;
}

#TOC a span {
  margin-left: 0.5em;
}

#TOC a .toc-section-number {
  margin-left: 0;
}

/* Callout blocks */

.alert {
  padding-bottom: 0 !important;
}

/* Code */

pre {
  overflow: auto;
  word-wrap: normal;
  margin: 0 0 1.275em;
  padding: .85em 1em;
  background: #f7f7f7;
}

pre.sourceCode.r {
  padding: 0;
}

pre.sourceCode.r div {
  padding: .85em 1em;
}

/* Foldables */

.foldable {
  margin: 0 0 1.275em;
  padding: .85em 1em 0 1em;
  background: #f7f7f7;
}

.foldable a {
  display: block;
  color: #212529;
  padding-bottom: 1em;
}

.foldable .show > p {
  padding-bottom: 1em;
  margin-bottom: 0;
}

.foldable .show > ul {
  padding-bottom: 1em;
}

/* Buttons */

.btn-primary, .btn-primary:hover, .btn-primary:focus {
  background-color: var(--primary-color);
  border-color: var(--primary-color);;
}

/* Links */

a {
  color: var(--primary-color);
}

.anchor-section {
  color: var(--primary-color) !important;
}

/* Blockquotes */

blockquote {
  border-left: 5px solid #f7f7f7;
  padding-left: 1em;
  font-style: italic;
}

blockquote p {
  padding: 0.25em;
}
</style>


<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">

<link
  rel="stylesheet"
  href="https://unpkg.com/littlefoot/dist/littlefoot.css"
/>

<!--<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
-->

</head>

<body>
  <div id="wrapper" class="d-flex">
    

<div class="border-end bg-white" id="sidebar-wrapper">
  <div id="sidebar-heading" class="border-bottom bg-light">
    <img src="bulb.png" width="25px" height="25px"/>
    <span class="text-nowrap">EA Market testing data analysis</span>
  </div>
  <div id="TOC" class="list-group list-group-flush">
  <a id="item-about" class="list-group-item" href="index.html">About</a>
  <div class="list-group list-group-flush list-subgroup">
  <a id="item-tech-and-collophon" class="list-group-item" href="index.html#tech-and-collophon"><span class="toc-section-number">0.1</span><span>Tech and collophon</a>
  </div>
  <a id="item-oftw_pregt" class="list-group-item" href="oftw_pregt.html"><span class="toc-section-number">1</span><span>OftW pre-giving-tuesday-email upselling split test (considering ‘impact vs emotion’)</a>
  <div class="list-group list-group-flush list-subgroup">
  <a id="item-the-trial" class="list-group-item" href="oftw_pregt.html#the-trial"><span class="toc-section-number">1.1</span><span>The trial</a>
  <a id="item-capturing-data" class="list-group-item" href="oftw_pregt.html#capturing-data"><span class="toc-section-number">1.2</span><span>Capturing data</a>
  <a id="item-input-and-clean-data" class="list-group-item" href="oftw_pregt.html#input-and-clean-data"><span class="toc-section-number">1.3</span><span>Input and clean data</a>
  <a id="item-descriptives-and-exploratory-analysis" class="list-group-item" href="oftw_pregt.html#descriptives-and-exploratory-analysis"><span class="toc-section-number">1.4</span><span>Descriptives and exploratory analysis</a>
  <a id="item-basic-tests-donation-incidence-and-amounts" class="list-group-item" href="oftw_pregt.html#basic-tests-donation-incidence-and-amounts"><span class="toc-section-number">1.5</span><span>Basic tests: Donation incidence and amounts</a>
  <a id="item-basic-tests-clicks-and-retention-outcomes" class="list-group-item" href="oftw_pregt.html#basic-tests-clicks-and-retention-outcomes"><span class="toc-section-number">1.6</span><span>Basic tests: Clicks and retention outcomes</a>
  <a id="item-demographics-and-interactions-to-do" class="list-group-item" href="oftw_pregt.html#demographics-and-interactions-to-do"><span class="toc-section-number">1.7</span><span>Demographics and interactions (to do)</a>
  </div>
  </div>
</div>
<!-- Page content wrapper-->
    <div id="page-content-wrapper">
<!-- Top navigation-->
    <nav 
      id="navbar" 
      class="navbar navbar-expand-lg navbar-light bg-light border-bottom"
    >
      <div class="container-fluid">
        <button class="btn btn-primary p-1" id="sidebarToggle">
          <svg 
            xmlns="http://www.w3.org/2000/svg" 
            width="26" 
            height="26" 
            fill="currentColor" 
            class="bi bi-list" viewBox="0 0 16 16"
          >
            <path 
              fill-rule="evenodd" 
              d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
          </svg>
        </button>
        <button 
          class="navbar-toggler" 
          type="button" 
          data-bs-toggle="collapse" 
          data-bs-target="#navbarContent" 
          aria-controls="navbarContent" 
          aria-expanded="false" 
          aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav ms-auto mt-2 mt-lg-0">
            <li class="nav-item dropdown">
              <a 
                class="nav-link dropdown-toggle" 
                id="navbarDropdown" 
                href="#" 
                role="button" 
                data-bs-toggle="dropdown" 
                aria-haspopup="true" 
                aria-expanded="false">
                  Settings
              </a>
              <div 
                class="dropdown-menu dropdown-menu-end" 
                aria-labelledby="navbarDropdown">
                  <a id="toggleCodeButton" class="dropdown-item" href="#!">Toggle code</a>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </nav>
<!-- Page content-->
    <div id="main-container" class="container-fluid">
<main>
<div id="oftw_pregt" class="section level1" number="1">
<h1><span class="header-section-number">1</span> OftW pre-giving-tuesday-email upselling split test (considering ‘impact vs emotion’)</h1>
<div id="the-trial" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> The trial</h2>
<p>In December 2021, OftW sent out a sequence of emails to existing OftW pledgers/participants asking them for an additional donation. There were two ‘treatment variants’; an emotional email and a standard impact-based email. The treatment was constant by individual (the same person always got emails with the same theme.</p>
<p>The details are presented in our (currently private) gitbook <a href="https://app.gitbook.com/o/-MfFk4CTSGwVOPkwnRgx/s/-Mf8cHxdwePMZXRTKnEE/contexts-and-environments-for-testing/one-for-the-world/pre-giving-tuesday-email-split-test">HERE</a> and in the linked pre-registration (also on OSF).</p>
</div>
<div id="capturing-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Capturing data</h2>
<p>Kennan and Chloe captured the data and Metadata from</p>
<ol style="list-style-type: decimal">
<li>The OFTW database</li>
<li>SurveyMonkey</li>
</ol>
<p>Putting this into the (private) Google sheet linked <a href="https://docs.google.com/spreadsheets/d/1iUKXkEqoadBgtUG_epBzUzCgA_J5mdWWstcXtpAdNJs/edit#gid=521638649">HERE</a></p>
<p>We added some metadata/explainers to that data.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<!-- (This is gitignored so it won't be 'committed' to our repo, at least for now)

Quick note here on how Kennan put the (different types of) data together in that Gsheet. We probably should use the API tool to import it directly here. -->
</div>
<div id="input-and-clean-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Input and clean data</h2>
<p>We input the sheets from the external Google sheet location (access required)…</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb2-1"><a href="oftw_pregt.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gs4_auth</span>(<span class="at">scope =</span> <span class="st">&quot;https://www.googleapis.com/auth/drive&quot;</span>)</span>
<span id="cb2-2"><a href="oftw_pregt.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drive_auth</span>(<span class="at">token =</span> <span class="fu">gs4_token</span>())</span>
<span id="cb2-3"><a href="oftw_pregt.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="oftw_pregt.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Mailchimp data </span></span>
<span id="cb2-5"><a href="oftw_pregt.html#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="oftw_pregt.html#cb2-6" aria-hidden="true" tabindex="-1"></a>oftw_21_22_mc <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(<span class="st">&quot;https://docs.google.com/spreadsheets/d/1iUKXkEqoadBgtUG_epBzUzCgA_J5mdWWstcXtpAdNJs/edit#gid=521638649&quot;</span>, </span>
<span id="cb2-7"><a href="oftw_pregt.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet=</span><span class="st">&quot;Raw data (Mailchimp)&quot;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="oftw_pregt.html#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Treatment group</span><span class="st">`</span>) <span class="sc">%&gt;%</span>  <span class="co">#remove an un-useful repeated name column </span></span>
<span id="cb2-9"><a href="oftw_pregt.html#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Treatment Group</span><span class="st">`</span> <span class="ot">=</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(<span class="st">`</span><span class="at">Treatment Group</span><span class="st">`</span>, <span class="sc">~</span> .[[<span class="dv">1</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="oftw_pregt.html#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Email Address</span><span class="st">`</span>, <span class="st">`</span><span class="at">Email Date</span><span class="st">`</span>, <span class="st">`</span><span class="at">Treatment Group</span><span class="st">`</span>, Opens, <span class="st">`</span><span class="at">Donate link clicks</span><span class="st">`</span>, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> <span class="co">#Most relevant features organized first</span></span>
<span id="cb2-11"><a href="oftw_pregt.html#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="st">`</span><span class="at">Email Address</span><span class="st">`</span>)</span>
<span id="cb2-12"><a href="oftw_pregt.html#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="oftw_pregt.html#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="oftw_pregt.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#later: remove features brought in from OFTW database, reconstruct it</span></span>
<span id="cb2-15"><a href="oftw_pregt.html#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="oftw_pregt.html#cb2-16" aria-hidden="true" tabindex="-1"></a>oftw_21_22_mc <span class="sc">%&gt;%</span> <span class="fu">names</span>() <span class="sc">%&gt;%</span> <span class="fu">paste</span>(<span class="at">collapse=</span><span class="st">&quot;, &quot;</span>)</span></code></div></pre></div>
<pre><code>## [1] &quot;Email Address, Email Date, Treatment Group, Opens, Donate link clicks, sheet_descriptor, First Name, Last Name, Email Number, Class Year, Donor status, Total Given, Donation amount, Donation frequency, Start string, Platform, Portfolio string, Class lead, Impact 1, Impact 2, Impact 3, Employer, Pledge string, School string, Pledge year, Cancellation Type, Donation Amount String, OFTW matching, OFTW match amount, Corporate match amount, Bonuses announced, Post-bonus contact date, Email Preferences, Start Date, Lives Saved, Member Rating, Record rank, Total Giving Season contributions, Total Giving Season contribution amount&quot;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb4-1"><a href="oftw_pregt.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#...input descriptors for the above (do this later from &quot;doc: ...Mailchimp&quot; sheet</span></span></code></div></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb5-1"><a href="oftw_pregt.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Donations data (and OftW database info)</span></span>
<span id="cb5-2"><a href="oftw_pregt.html#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="oftw_pregt.html#cb5-3" aria-hidden="true" tabindex="-1"></a>oftw_21_22_db_don <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(</span>
<span id="cb5-4"><a href="oftw_pregt.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://docs.google.com/spreadsheets/d/1iUKXkEqoadBgtUG_epBzUzCgA_J5mdWWstcXtpAdNJs/edit#gid=521638649&quot;</span>, </span>
<span id="cb5-5"><a href="oftw_pregt.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet=</span><span class="st">&quot;Giving Season contributions (BigQuery)&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="oftw_pregt.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Treatment group</span><span class="st">`</span> <span class="ot">=</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(<span class="st">`</span><span class="at">Treatment group</span><span class="st">`</span>, <span class="sc">~</span> .[[<span class="dv">1</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="oftw_pregt.html#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">`</span><span class="at">email</span><span class="st">`</span>, <span class="st">`</span><span class="at">primary_email</span><span class="st">`</span>, <span class="st">`</span><span class="at">donation_date</span><span class="st">`</span>, <span class="st">`</span><span class="at">Net_Contribution_Amount_USD</span><span class="st">`</span>, <span class="st">`</span><span class="at">payment_platform</span><span class="st">`</span>, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span>  <span class="co">#Most relevant features organized first</span></span>
<span id="cb5-8"><a href="oftw_pregt.html#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(donation_date<span class="sc">&gt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;2021-11-15&quot;</span>)) <span class="co"># At least for now, remove pre-treatment donation data</span></span>
<span id="cb5-9"><a href="oftw_pregt.html#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="oftw_pregt.html#cb5-10" aria-hidden="true" tabindex="-1"></a>oftw_21_22_db_don <span class="sc">%&gt;%</span> <span class="fu">names</span>() <span class="sc">%&gt;%</span> <span class="fu">paste</span>(<span class="at">collapse=</span><span class="st">&quot;, &quot;</span>)</span></code></div></pre></div>
<pre><code>## [1] &quot;email, primary_email, donation_date, Net_Contribution_Amount_USD, payment_platform, Treatment group, Number of email opens, oftw_partner, school, chapter_type, portfolio, contribution_frequency, pledge_date, pledge_start_date, pledge_end_date, donor_status, cancellation_type, pledge_amount, pledge_contribution_frequency, x&quot;</code></pre>
<!-- 

For the first question, we'll need to transform the contribution data to look at how many contributions came from people in each group who actually opened the emails (Column D) and then further subset it to just website donations (ie Column I = "Squarespace").

For the second, I just updated the formulas in both of those columns. Remember that, since the Raw Data (Mailchimp) tab holds one observation for each email-open by a given donor, an individual donor may appear up to five times. Accordingly, summing these aggregated columns will vastly inflate the totals. We may be better off making a unique() call to the emails and constructing a donor-level dataset separately. Happy to talk more tomorrow (or next week if those times don't work).
-->
<div id="labeling-and-cleaning" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Labeling and cleaning</h3>
<p>The code …</p>
<p>…makes names <code>snake_case</code>, using original names as labels…</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb7-1"><a href="oftw_pregt.html#cb7-1" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">var_label</span>(oftw_21_22_mc) <span class="ot">&lt;-</span> <span class="fu">names</span>(oftw_21_22_mc) </span>
<span id="cb7-2"><a href="oftw_pregt.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(oftw_21_22_mc) <span class="ot">&lt;-</span> snakecase<span class="sc">::</span><span class="fu">to_snake_case</span>(<span class="fu">names</span>(oftw_21_22_mc)) </span>
<span id="cb7-3"><a href="oftw_pregt.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="oftw_pregt.html#cb7-4" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">var_label</span>(oftw_21_22_db_don) <span class="ot">&lt;-</span> <span class="fu">names</span>(oftw_21_22_db_don) </span>
<span id="cb7-5"><a href="oftw_pregt.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(oftw_21_22_db_don) <span class="ot">&lt;-</span> snakecase<span class="sc">::</span><span class="fu">to_snake_case</span>(<span class="fu">names</span>(oftw_21_22_db_don)) </span></code></div></pre></div>
<!--Todo: Remove useless columns -->
<p>…and anonymizes the data, hashing anything with the chance of being identifying</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb8-1"><a href="oftw_pregt.html#cb8-1" aria-hidden="true" tabindex="-1"></a>salty_hash <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-2"><a href="oftw_pregt.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">salt</span>(<span class="at">.seed =</span> <span class="dv">42</span>, x) <span class="sc">%&gt;%</span> <span class="fu">hash</span>(<span class="at">.algo =</span> <span class="st">&quot;crc32&quot;</span>)</span>
<span id="cb8-3"><a href="oftw_pregt.html#cb8-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-4"><a href="oftw_pregt.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="oftw_pregt.html#cb8-5" aria-hidden="true" tabindex="-1"></a>oftw_21_22_mc <span class="ot">&lt;-</span> oftw_21_22_mc <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="oftw_pregt.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>first_name, <span class="sc">-</span>last_name) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="oftw_pregt.html#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(email_address,  employer, school_string), salty_hash))</span>
<span id="cb8-8"><a href="oftw_pregt.html#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="oftw_pregt.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="oftw_pregt.html#cb8-10" aria-hidden="true" tabindex="-1"></a>oftw_21_22_db_don <span class="ot">&lt;-</span> oftw_21_22_db_don <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="oftw_pregt.html#cb8-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(primary_email, email, school), salty_hash))</span></code></div></pre></div>
<p>Roll up to 1 per person; summarize and pivot_wider</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb9-1"><a href="oftw_pregt.html#cb9-1" aria-hidden="true" tabindex="-1"></a>outcomes_base_mc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;opens&quot;</span>, <span class="st">&quot;donate_link_clicks&quot;</span>)</span>
<span id="cb9-2"><a href="oftw_pregt.html#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="oftw_pregt.html#cb9-3" aria-hidden="true" tabindex="-1"></a>oftw_21_22_mc_wide <span class="ot">&lt;-</span> oftw_21_22_mc <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="oftw_pregt.html#cb9-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb9-5"><a href="oftw_pregt.html#cb9-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">treat_emotion =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-6"><a href="oftw_pregt.html#cb9-6" aria-hidden="true" tabindex="-1"></a>        treatment_group<span class="sc">==</span><span class="st">&quot;1.000000&quot;</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb9-7"><a href="oftw_pregt.html#cb9-7" aria-hidden="true" tabindex="-1"></a>        treatment_group <span class="sc">==</span> <span class="st">&quot;2.000000&quot;</span> <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb9-8"><a href="oftw_pregt.html#cb9-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="oftw_pregt.html#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(email_address) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="oftw_pregt.html#cb9-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(outcomes_base_mc), sum, <span class="at">.names =</span> <span class="st">&quot;{.col}_tot&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="oftw_pregt.html#cb9-11" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> email_number, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&quot;opens&quot;</span>, <span class="st">&quot;donate_link_clicks&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="oftw_pregt.html#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_click_don_link =</span> donate_link_clicks_tot <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-13"><a href="oftw_pregt.html#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(email_address) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="oftw_pregt.html#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb9-15"><a href="oftw_pregt.html#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="oftw_pregt.html#cb9-16" aria-hidden="true" tabindex="-1"></a>oftw_21_22_db_don <span class="ot">&lt;-</span> oftw_21_22_db_don <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="oftw_pregt.html#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="oftw_pregt.html#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(email) <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="oftw_pregt.html#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-20"><a href="oftw_pregt.html#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">don_tot =</span> <span class="fu">sum</span>(net_contribution_amount_usd),</span>
<span id="cb9-21"><a href="oftw_pregt.html#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_don =</span> <span class="fu">n</span>(),</span>
<span id="cb9-22"><a href="oftw_pregt.html#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">d_don =</span> num_don <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb9-23"><a href="oftw_pregt.html#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">don_tot_ot =</span> <span class="fu">sum</span>(net_contribution_amount_usd[contribution_frequency <span class="sc">==</span></span>
<span id="cb9-24"><a href="oftw_pregt.html#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;One-time&quot;</span>]),</span>
<span id="cb9-25"><a href="oftw_pregt.html#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_don_ot =</span> <span class="fu">sum</span>(contribution_frequency <span class="sc">==</span> <span class="st">&quot;One-time&quot;</span>),</span>
<span id="cb9-26"><a href="oftw_pregt.html#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">d_don_ot =</span> num_don_ot <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb9-27"><a href="oftw_pregt.html#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#WAIT THIS IS NOT WIDE DATA -- don&#39;t interpret it as &#39;number of individuals&#39;</span></span>
<span id="cb9-28"><a href="oftw_pregt.html#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">don_tot_ss =</span> <span class="fu">sum</span>(net_contribution_amount_usd[payment_platform <span class="sc">==</span> <span class="st">&quot;Squarespace&quot;</span>]),</span>
<span id="cb9-29"><a href="oftw_pregt.html#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_don_ss =</span> <span class="fu">sum</span>(payment_platform <span class="sc">==</span> <span class="st">&quot;Squarespace&quot;</span>),</span>
<span id="cb9-30"><a href="oftw_pregt.html#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">d_don_ss =</span> num_don_ss <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb9-31"><a href="oftw_pregt.html#cb9-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-32"><a href="oftw_pregt.html#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="oftw_pregt.html#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="oftw_pregt.html#cb9-34" aria-hidden="true" tabindex="-1"></a>oftw_21_22_db_don_persons <span class="ot">&lt;-</span> oftw_21_22_db_don <span class="sc">%&gt;%</span>  </span>
<span id="cb9-35"><a href="oftw_pregt.html#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(email) <span class="sc">%&gt;%</span></span>
<span id="cb9-36"><a href="oftw_pregt.html#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb9-37"><a href="oftw_pregt.html#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="oftw_pregt.html#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="oftw_pregt.html#cb9-39" aria-hidden="true" tabindex="-1"></a>oftw_mc_db <span class="ot">&lt;-</span> <span class="fu">full_join</span>(oftw_21_22_mc_wide,</span>
<span id="cb9-40"><a href="oftw_pregt.html#cb9-40" aria-hidden="true" tabindex="-1"></a>  oftw_21_22_db_don_persons,</span>
<span id="cb9-41"><a href="oftw_pregt.html#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;email_address&quot;</span> <span class="ot">=</span> <span class="st">&quot;email&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-42"><a href="oftw_pregt.html#cb9-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;d_don&quot;</span>), <span class="sc">~</span><span class="fu">replace</span>(., <span class="fu">is.na</span>(.), <span class="dv">0</span>)), <span class="co">#make it a 0 if it&#39;s not in the donation database</span></span>
<span id="cb9-43"><a href="oftw_pregt.html#cb9-43" aria-hidden="true" tabindex="-1"></a>   <span class="at">d_open=</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(treat_emotion),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb9-44"><a href="oftw_pregt.html#cb9-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-45"><a href="oftw_pregt.html#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="oftw_pregt.html#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="oftw_pregt.html#cb9-47" aria-hidden="true" tabindex="-1"></a>oftw_mc_db_openers <span class="ot">&lt;-</span> oftw_mc_db <span class="sc">%&gt;%</span> </span>
<span id="cb9-48"><a href="oftw_pregt.html#cb9-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(treat_emotion))</span>
<span id="cb9-49"><a href="oftw_pregt.html#cb9-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="oftw_pregt.html#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co"># oftw_21_22_db_don_wide &lt;- oftw_21_22_db_don %&gt;%</span></span>
<span id="cb9-51"><a href="oftw_pregt.html#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(email, donation_date, net_contribution_amount_usd, payment_platform) %&gt;% </span></span>
<span id="cb9-52"><a href="oftw_pregt.html#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#    group_by(email) %&gt;%</span></span>
<span id="cb9-53"><a href="oftw_pregt.html#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co">#    mutate(row = row_number()) %&gt;%</span></span>
<span id="cb9-54"><a href="oftw_pregt.html#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co">#       tidyr::pivot_wider(names_from = row, values_from = c(&quot;donation_date&quot;, &quot;net_contribution_amount_usd&quot;))</span></span></code></div></pre></div>
<p>Prelim results</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb10-1"><a href="oftw_pregt.html#cb10-1" aria-hidden="true" tabindex="-1"></a>oftw_mc_db <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(treat_emotion, d_don)</span></code></div></pre></div>
<pre><code>##  treat_emotion    0   1
##              0 1139 266
##              1  968 222
##             NA    0 411</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb12-1"><a href="oftw_pregt.html#cb12-1" aria-hidden="true" tabindex="-1"></a>oftw_mc_db <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(treat_emotion, d_don_ss)</span></code></div></pre></div>
<pre><code>##  treat_emotion    0 1
##              0 1397 8
##              1 1181 9
##             NA  407 4</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb14-1"><a href="oftw_pregt.html#cb14-1" aria-hidden="true" tabindex="-1"></a>oftw_21_22_db_don_persons <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(treat_emotion, d_don_ot)</span></code></div></pre></div>
<pre><code>## Error in `dplyr::select()`:
## ! Can&#39;t subset columns that don&#39;t exist.
## x Column `treat_emotion` doesn&#39;t exist.</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb16-1"><a href="oftw_pregt.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#todo: simple statistical measures along with this</span></span></code></div></pre></div>
</div>
<div id="constructing-outcome-measures-especially-donations-likely-driven-by-email" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Constructing outcome measures, especially ‘donations likely driven by email’</h3>
<ol style="list-style-type: decimal">
<li>Donations (presence, count, amounts) in giving seasons, 1 row per user (with treatment etc.)</li>
</ol>
<ul>
<li>overall</li>
<li>non-regular</li>
<li>‘likely from email’</li>
</ul>
<p>are in Giving Season contributions (BigQuery)</p>
<ul>
<li>subset for payment platform = squarespace (unlikely to come from any other checkout page)</li>
<li>email as primary key, link to <code>Raw Data (mailchimp)</code>, filter on ‘Donate link clicks`&gt;0
(note that one needs aggregating by donor because it is ’per email’)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Giving season donations ..</li>
</ol>
<p>Giving Season contributions (BigQuery), sum donation_date Net_Contribution_Amount_USD with filters for one-time etc</p>
<p>Can check against fields ‘Total Giving Season contributions Total Giving Season contribution amount’</p>
<!-- Could make a nested array:
- Dates emails sent, number of clicks per email
- Dates donations made, donation amount -->
<div class="sourceCode" id="cb17"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb17-1"><a href="oftw_pregt.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#list/matrix of rates for later use</span></span>
<span id="cb17-2"><a href="oftw_pregt.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="oftw_pregt.html#cb17-3" aria-hidden="true" tabindex="-1"></a>oc_mat <span class="ot">&lt;-</span> oftw_mc_db <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="oftw_pregt.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_open=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="oftw_pregt.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treat_emotion) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="oftw_pregt.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;d_&quot;</span>), <span class="sc">~</span><span class="fu">sum</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">&quot;tot_{.col}&quot;</span>))</span>
<span id="cb17-7"><a href="oftw_pregt.html#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="oftw_pregt.html#cb17-8" aria-hidden="true" tabindex="-1"></a>oc_mat_r <span class="ot">&lt;-</span> oc_mat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(treat_emotion)) <span class="co">#where treatment observed </span></span>
<span id="cb17-9"><a href="oftw_pregt.html#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="oftw_pregt.html#cb17-10" aria-hidden="true" tabindex="-1"></a>assigned_emails <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2000</span>) <span class="co">#I was told that about 4000 emails were sent, 2000 to each group</span></span></code></div></pre></div>
</div>
</div>
<div id="descriptives-and-exploratory-analysis" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Descriptives and exploratory analysis</h2>
<p>Notes:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div id="donation-and-outcome-summary-statistics-by-treatment" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Donation and outcome summary statistics, by treatment</h3>
</div>
</div>
<div id="basic-tests-donation-incidence-and-amounts" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Basic tests: Donation incidence and amounts</h2>
<p>(See preregistration – go through preregistered tests one at a time. Note that given the observed conversion rates I do not expect any ‘significant differences.’)</p>
</div>
<div id="basic-tests-clicks-and-retention-outcomes" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Basic tests: Clicks and retention outcomes</h2>
<p>I’m following the approach discussed in the ‘RP methods discussion’ under <a href="">“Significance and equivalence testing” with randomization inference/simulation; building to Bayes</a></p>
<p>We see a ‘small difference’ between treatment groups and it is ‘not significant in standard tests’ (tests not shown here yet). But can we put meaningful bounds on this? Can we statistically ‘rule out large effects?’</p>
<p>(This parallels the analysis done in <a href="https://rethinkpriorities.github.io/methodology-statistics-design/inference-and-rough-equivalence-testing-with-binomial-outcomes.html#how-likely-are-proportions-this-similar-under-different-size-true-effect-sizes">HERE</a>, which includes some further explanation of the methods)</p>
<p><br />
</p>
<div id="difference-between-two-binomial-random-variables-bayesian-binomial-test" class="section level3" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Difference between two binomial random variables: Bayesian binomial test</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb18-1"><a href="oftw_pregt.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#would need to generate &#39;fill in data&#39; if we want to use bayesAB, which requires actual vectors</span></span>
<span id="cb18-2"><a href="oftw_pregt.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="oftw_pregt.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#add blank rows for &#39;assigned&#39;</span></span>
<span id="cb18-4"><a href="oftw_pregt.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="oftw_pregt.html#cb18-5" aria-hidden="true" tabindex="-1"></a>blank_impact <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> assigned_emails[<span class="dv">1</span>]<span class="sc">-</span> oc_mat_r<span class="sc">$</span>tot_d_open[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">NCOL</span>(oftw_mc_db)))</span>
<span id="cb18-6"><a href="oftw_pregt.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(blank_impact) <span class="ot">&lt;-</span> <span class="fu">names</span>(oftw_mc_db)</span>
<span id="cb18-7"><a href="oftw_pregt.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="oftw_pregt.html#cb18-8" aria-hidden="true" tabindex="-1"></a>blank_impact <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb18-9"><a href="oftw_pregt.html#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;d_&quot;</span>), <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>, <span class="dv">0</span>)),</span>
<span id="cb18-10"><a href="oftw_pregt.html#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat_emotion=</span><span class="dv">0</span>)</span>
<span id="cb18-11"><a href="oftw_pregt.html#cb18-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-12"><a href="oftw_pregt.html#cb18-12" aria-hidden="true" tabindex="-1"></a>blank_emotion <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> assigned_emails[<span class="dv">1</span>]<span class="sc">-</span> oc_mat_r<span class="sc">$</span>tot_d_open[<span class="dv">2</span>], <span class="at">ncol =</span> <span class="fu">NCOL</span>(oftw_mc_db)))</span>
<span id="cb18-13"><a href="oftw_pregt.html#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(blank_emotion) <span class="ot">&lt;-</span> <span class="fu">names</span>(oftw_mc_db)</span>
<span id="cb18-14"><a href="oftw_pregt.html#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="oftw_pregt.html#cb18-15" aria-hidden="true" tabindex="-1"></a>blank_emotion <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb18-16"><a href="oftw_pregt.html#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;d_&quot;</span>), <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>, <span class="dv">0</span>)),</span>
<span id="cb18-17"><a href="oftw_pregt.html#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat_emotion=</span><span class="dv">1</span>)</span>
<span id="cb18-18"><a href="oftw_pregt.html#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="oftw_pregt.html#cb18-19" aria-hidden="true" tabindex="-1"></a>oftw_mc_db_assigned <span class="ot">&lt;-</span> </span>
<span id="cb18-20"><a href="oftw_pregt.html#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(oftw_mc_db, blank_impact, blank_emotion) <span class="sc">%&gt;%</span></span>
<span id="cb18-21"><a href="oftw_pregt.html#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(treat_emotion))</span>
<span id="cb18-22"><a href="oftw_pregt.html#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="oftw_pregt.html#cb18-23" aria-hidden="true" tabindex="-1"></a>oftw_mc_db_assigned <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(treat_emotion)</span></code></div></pre></div>
<pre><code>##  treat_emotion    n percent
##              0 2000     0.5
##              1 2000     0.5</code></pre>
<p>Opens by treatment:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb20-1"><a href="oftw_pregt.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following r https://www.sumsar.net/blog/2014/06/bayesian-first-aid-prop-test/  </span></span>
<span id="cb20-2"><a href="oftw_pregt.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># alt: http://frankportman.github.io/bayesAB/ </span></span>
<span id="cb20-3"><a href="oftw_pregt.html#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="oftw_pregt.html#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="oftw_pregt.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#opens_by_treat_fit &lt;- bayes.prop.test(oc_mat_r$tot_d_open, assigned_emails, cred.mass = 0.95) #here I highlight the 95% bounds because it&#39;s a strong effect!</span></span>
<span id="cb20-6"><a href="oftw_pregt.html#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="oftw_pregt.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(opens_by_treat_fit)</span></span>
<span id="cb20-8"><a href="oftw_pregt.html#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="oftw_pregt.html#cb20-9" aria-hidden="true" tabindex="-1"></a>unif_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;alpha&#39;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&#39;beta&#39;</span> <span class="ot">=</span> <span class="dv">1</span>)</span>
<span id="cb20-10"><a href="oftw_pregt.html#cb20-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb20-11"><a href="oftw_pregt.html#cb20-11" aria-hidden="true" tabindex="-1"></a>empir_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;alpha&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_open), <span class="st">&#39;beta&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(assigned_emails))</span>
<span id="cb20-12"><a href="oftw_pregt.html#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="oftw_pregt.html#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="oftw_pregt.html#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">#same with AB  package</span></span>
<span id="cb20-15"><a href="oftw_pregt.html#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit bernoulli test</span></span>
<span id="cb20-16"><a href="oftw_pregt.html#cb20-16" aria-hidden="true" tabindex="-1"></a>opens_by_treat_AB <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb20-17"><a href="oftw_pregt.html#cb20-17" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_open[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb20-18"><a href="oftw_pregt.html#cb20-18" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_open[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb20-19"><a href="oftw_pregt.html#cb20-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> unif_prior,</span>
<span id="cb20-20"><a href="oftw_pregt.html#cb20-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb20-21"><a href="oftw_pregt.html#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="oftw_pregt.html#cb20-22" aria-hidden="true" tabindex="-1"></a>opens_by_treat_AB_empir <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb20-23"><a href="oftw_pregt.html#cb20-23" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_open[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb20-24"><a href="oftw_pregt.html#cb20-24" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_open[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb20-25"><a href="oftw_pregt.html#cb20-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> empir_prior,</span>
<span id="cb20-26"><a href="oftw_pregt.html#cb20-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb20-27"><a href="oftw_pregt.html#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="oftw_pregt.html#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(opens_by_treat_AB) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-7-2.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-7-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb21-1"><a href="oftw_pregt.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(opens_by_treat_AB_empir) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-4.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-7-5.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-7-6.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb22-1"><a href="oftw_pregt.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#WTF -- I need to advance this by command prompt!?</span></span>
<span id="cb22-2"><a href="oftw_pregt.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="oftw_pregt.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#AB1 &lt;- bayesTest(oftw_21_22_db_don_persons$d_don_ot[trea], B_binom, priors = c(&#39;alpha&#39; = 65, &#39;beta&#39; = 200), n_samples = 1e5, distribution = &#39;bernoulli&#39;)</span></span></code></div></pre></div>
<p><br />
</p>
<p>‘Some donation’ by treatment (only for those who opened, otherwise donations are surely undercounted for Emotion treatment)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb23-1"><a href="oftw_pregt.html#cb23-1" aria-hidden="true" tabindex="-1"></a>oftw_21_22_db_don_persons <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(treat_emotion, d_don)</span></code></div></pre></div>
<pre><code>## Error in `dplyr::select()`:
## ! Can&#39;t subset columns that don&#39;t exist.
## x Column `treat_emotion` doesn&#39;t exist.</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb25-1"><a href="oftw_pregt.html#cb25-1" aria-hidden="true" tabindex="-1"></a>empir_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;alpha&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_don), <span class="st">&#39;beta&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_open))</span>
<span id="cb25-2"><a href="oftw_pregt.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="oftw_pregt.html#cb25-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb25-4"><a href="oftw_pregt.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  don_by_treat_opened_fit <span class="ot">&lt;-</span> <span class="fu">bayes.prop.test</span>(oc_mat_r<span class="sc">$</span>tot_d_don, oc_mat_r<span class="sc">$</span>tot_d_open, <span class="at">cred.mass =</span> <span class="fl">0.80</span>) <span class="co"># 80% credible interval for decision-making purposes</span></span>
<span id="cb25-5"><a href="oftw_pregt.html#cb25-5" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<pre><code>## 
##  Bayesian First Aid proportion test
## 
## data: oc_mat_r$tot_d_don out of oc_mat_r$tot_d_open
## number of successes:   266,  222
## number of trials:     1405, 1190
## Estimated relative frequency of success [80% credible interval]:
##   Group 1: 0.19 [0.18, 0.20]
##   Group 2: 0.19 [0.17, 0.20]
## Estimated group difference (Group 1 - Group 2):
##   0 [-0.017, 0.022]
## The relative frequency of success is larger for Group 1 by a probability
## of 0.571 and larger for Group 2 by a probability of 0.429 .</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb27-1"><a href="oftw_pregt.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_by_treat_opened_fit)</span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb28-1"><a href="oftw_pregt.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#same with AB  package</span></span>
<span id="cb28-2"><a href="oftw_pregt.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit bernoulli test</span></span>
<span id="cb28-3"><a href="oftw_pregt.html#cb28-3" aria-hidden="true" tabindex="-1"></a>don_by_treat_AB <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb28-4"><a href="oftw_pregt.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb28-5"><a href="oftw_pregt.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb28-6"><a href="oftw_pregt.html#cb28-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> unif_prior,</span>
<span id="cb28-7"><a href="oftw_pregt.html#cb28-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb28-8"><a href="oftw_pregt.html#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="oftw_pregt.html#cb28-9" aria-hidden="true" tabindex="-1"></a>don_by_treat_AB_empir <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb28-10"><a href="oftw_pregt.html#cb28-10" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb28-11"><a href="oftw_pregt.html#cb28-11" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb28-12"><a href="oftw_pregt.html#cb28-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> empir_prior,</span>
<span id="cb28-13"><a href="oftw_pregt.html#cb28-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb28-14"><a href="oftw_pregt.html#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="oftw_pregt.html#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_by_treat_AB) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-2.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-8-3.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-8-4.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb29-1"><a href="oftw_pregt.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_by_treat_AB_empir) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-5.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-8-6.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-8-7.png" width="80%" style="display: block; margin: auto;" />
Thus we put 80% probability on the difference between the donation rates being no more than (hard-coded) .023/.19 = 12% in either direction. Note that this is not terribly narrowly bounded.</p>
<p><br />
</p>
<p><em>Next, for one-time donations only; again as a share of opens</em></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb30-1"><a href="oftw_pregt.html#cb30-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb30-2"><a href="oftw_pregt.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  don_ot_by_treat_opened_fit <span class="ot">&lt;-</span> <span class="fu">bayes.prop.test</span>(oc_mat_r<span class="sc">$</span>tot_d_don_ot, oc_mat_r<span class="sc">$</span>tot_d_open, <span class="at">cred.mass =</span> <span class="fl">0.80</span>) <span class="co"># 80% credible interval for decision-making purposes</span></span>
<span id="cb30-3"><a href="oftw_pregt.html#cb30-3" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<pre><code>## 
##  Bayesian First Aid proportion test
## 
## data: oc_mat_r$tot_d_don_ot out of oc_mat_r$tot_d_open
## number of successes:    15,   11
## number of trials:     1405, 1190
## Estimated relative frequency of success [80% credible interval]:
##   Group 1: 0.011 [0.0076, 0.015]
##   Group 2: 0.0098 [0.0060, 0.013]
## Estimated group difference (Group 1 - Group 2):
##   0 [-0.0037, 0.0065]
## The relative frequency of success is larger for Group 1 by a probability
## of 0.634 and larger for Group 2 by a probability of 0.366 .</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb32-1"><a href="oftw_pregt.html#cb32-1" aria-hidden="true" tabindex="-1"></a>empir_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;alpha&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_don_ot), <span class="st">&#39;beta&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_open))</span>
<span id="cb32-2"><a href="oftw_pregt.html#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="oftw_pregt.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#same with AB  package</span></span>
<span id="cb32-4"><a href="oftw_pregt.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit bernoulli test</span></span>
<span id="cb32-5"><a href="oftw_pregt.html#cb32-5" aria-hidden="true" tabindex="-1"></a>don_ot_by_treat_AB <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb32-6"><a href="oftw_pregt.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ot[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb32-7"><a href="oftw_pregt.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ot[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb32-8"><a href="oftw_pregt.html#cb32-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> unif_prior,</span>
<span id="cb32-9"><a href="oftw_pregt.html#cb32-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb32-10"><a href="oftw_pregt.html#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="oftw_pregt.html#cb32-11" aria-hidden="true" tabindex="-1"></a>don_ot_by_treat_AB_empir <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb32-12"><a href="oftw_pregt.html#cb32-12" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ot[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb32-13"><a href="oftw_pregt.html#cb32-13" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ot[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb32-14"><a href="oftw_pregt.html#cb32-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> empir_prior,</span>
<span id="cb32-15"><a href="oftw_pregt.html#cb32-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb32-16"><a href="oftw_pregt.html#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="oftw_pregt.html#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_ot_by_treat_AB) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-9-2.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-9-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb33-1"><a href="oftw_pregt.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_ot_by_treat_AB_empir) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-4.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-9-5.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-9-6.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb34-1"><a href="oftw_pregt.html#cb34-1" aria-hidden="true" tabindex="-1"></a>don_ot_by_treat_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.9</span>)</span></code></div></pre></div>
<pre><code>## Quantiles of posteriors for A and B:
## 
## $Probability
## $Probability$A
##          0%         25%         50%         75%        100% 
## 0.002715801 0.009346799 0.011131270 0.013121584 0.028621698 
## 
## $Probability$B
##          0%         25%         50%         75%        100% 
## 0.001978320 0.008007009 0.009798477 0.011841058 0.026721206 
## 
## 
## --------------------------------------------
## 
## P(A &gt; B) by (0)%: 
## 
## $Probability
## [1] 0.62982
## 
## --------------------------------------------
## 
## Credible Interval on (A - B) / B for interval length(s) (0.9) : 
## 
## $Probability
##         5%        95% 
## -0.3945133  1.1704637 
## 
## --------------------------------------------
## 
## Posterior Expected Loss for choosing A over B:
## 
## $Probability
## [1] 0.12218</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb36-1"><a href="oftw_pregt.html#cb36-1" aria-hidden="true" tabindex="-1"></a>don_ot_by_treat_AB_lift_int80 <span class="ot">&lt;-</span> don_ot_by_treat_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span>
<span id="cb36-2"><a href="oftw_pregt.html#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="oftw_pregt.html#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="oftw_pregt.html#cb36-4" aria-hidden="true" tabindex="-1"></a>don_ot_by_treat_AB_lift_int80_empir <span class="ot">&lt;-</span> don_ot_by_treat_AB_empir <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span></code></div></pre></div>
<p>80% credible intervals with the uniform prior for the ‘lift’ of Impact relative to Emotion are</p>
<p>-0.303, 0.877</p>
<p>and for the empirically informed (but symmetric prior):</p>
<p>-0.214, 0.402</p>
<p>(Hard-coded) Here there is just a trace of suggestive evidence that the emotion treatment performed worse. But even our 80% bounds are very wide.</p>
<p><br />
</p>
<p><em>For ‘Squarespace donations only’; these are the donations that plausibly came from the email. First as a share of opens for each treatment :</em></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb37-1"><a href="oftw_pregt.html#cb37-1" aria-hidden="true" tabindex="-1"></a>empir_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;alpha&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_don_ss), <span class="st">&#39;beta&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_open))</span>
<span id="cb37-2"><a href="oftw_pregt.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="oftw_pregt.html#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="oftw_pregt.html#cb37-4" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb37-5"><a href="oftw_pregt.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  don_ss_by_treat_opened_fit <span class="ot">&lt;-</span> <span class="fu">bayes.prop.test</span>(oc_mat_r<span class="sc">$</span>tot_d_don_ss, oc_mat_r<span class="sc">$</span>tot_d_open, <span class="at">cred.mass =</span> <span class="fl">0.80</span>) <span class="co"># 80% credible interval for decision-making purposes</span></span>
<span id="cb37-6"><a href="oftw_pregt.html#cb37-6" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<pre><code>## 
##  Bayesian First Aid proportion test
## 
## data: oc_mat_r$tot_d_don_ss out of oc_mat_r$tot_d_open
## number of successes:     8,    9
## number of trials:     1405, 1190
## Estimated relative frequency of success [80% credible interval]:
##   Group 1: 0.0061 [0.0036, 0.0087]
##   Group 2: 0.0081 [0.0048, 0.011]
## Estimated group difference (Group 1 - Group 2):
##   0 [-0.0062, 0.0022]
## The relative frequency of success is larger for Group 1 by a probability
## of 0.27 and larger for Group 2 by a probability of 0.73 .</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb39-1"><a href="oftw_pregt.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#same with AB  package</span></span>
<span id="cb39-2"><a href="oftw_pregt.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit bernoulli test</span></span>
<span id="cb39-3"><a href="oftw_pregt.html#cb39-3" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_AB <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb39-4"><a href="oftw_pregt.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ss[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb39-5"><a href="oftw_pregt.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ss[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb39-6"><a href="oftw_pregt.html#cb39-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> unif_prior,</span>
<span id="cb39-7"><a href="oftw_pregt.html#cb39-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb39-8"><a href="oftw_pregt.html#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="oftw_pregt.html#cb39-9" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_AB_empir <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb39-10"><a href="oftw_pregt.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ss[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb39-11"><a href="oftw_pregt.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_openers<span class="sc">$</span>d_don_ss[oftw_mc_db_openers<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb39-12"><a href="oftw_pregt.html#cb39-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> empir_prior,</span>
<span id="cb39-13"><a href="oftw_pregt.html#cb39-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb39-14"><a href="oftw_pregt.html#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="oftw_pregt.html#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="oftw_pregt.html#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_ss_by_treat_AB) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-10-2.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-10-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb40-1"><a href="oftw_pregt.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_ss_by_treat_AB_empir) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-4.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-10-5.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-10-6.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb41-1"><a href="oftw_pregt.html#cb41-1" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.9</span>)</span></code></div></pre></div>
<pre><code>## Quantiles of posteriors for A and B:
## 
## $Probability
## $Probability$A
##           0%          25%          50%          75%         100% 
## 0.0009951672 0.0048674196 0.0061674608 0.0076713743 0.0192364229 
## 
## $Probability$B
##          0%         25%         50%         75%        100% 
## 0.001473780 0.006486365 0.008102473 0.009965906 0.025915675 
## 
## 
## --------------------------------------------
## 
## P(A &gt; B) by (0)%: 
## 
## $Probability
## [1] 0.27719
## 
## --------------------------------------------
## 
## Credible Interval on (A - B) / B for interval length(s) (0.9) : 
## 
## $Probability
##         5%        95% 
## -0.6524174  0.6352614 
## 
## --------------------------------------------
## 
## Posterior Expected Loss for choosing A over B:
## 
## $Probability
## [1] 0.5379195</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb43-1"><a href="oftw_pregt.html#cb43-1" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_AB_lift_int80 <span class="ot">&lt;-</span> don_ss_by_treat_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span>
<span id="cb43-2"><a href="oftw_pregt.html#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="oftw_pregt.html#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="oftw_pregt.html#cb43-4" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_AB_lift_int80_empir <span class="ot">&lt;-</span> don_ss_by_treat_AB_empir <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span></code></div></pre></div>
<p>80% credible intervals with the uniform prior for the ‘lift’ of Impact relative to Emotion are</p>
<p>-0.585, 0.379</p>
<p>and for the empirically informed (but symmetric prior):</p>
<p>-0.367, 0.301</p>
<p>(Hard-coded) Again, even our 80% bounds are very wide.</p>
<p><br />
</p>
<p>Finally, we consider the above as a share of total emails sent, allowing that ‘opens’ is non-random,</p>
<p>… and also implicitly assuming that the only impact of these treatments could be on the Squarespace donations made by someone who did open the email.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb44-1"><a href="oftw_pregt.html#cb44-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb44-2"><a href="oftw_pregt.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  don_ss_by_treat_opened_fit_all <span class="ot">&lt;-</span> <span class="fu">bayes.prop.test</span>(oc_mat_r<span class="sc">$</span>tot_d_don_ss, assigned_emails,</span>
<span id="cb44-3"><a href="oftw_pregt.html#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cred.mass =</span> <span class="fl">0.80</span>) <span class="co"># 80% credible interval for decision-making purposes</span></span>
<span id="cb44-4"><a href="oftw_pregt.html#cb44-4" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<pre><code>## 
##  Bayesian First Aid proportion test
## 
## data: oc_mat_r$tot_d_don_ss out of assigned_emails
## number of successes:     8,    9
## number of trials:     2000, 2000
## Estimated relative frequency of success [80% credible interval]:
##   Group 1: 0.0043 [0.0024, 0.0061]
##   Group 2: 0.0049 [0.0027, 0.0066]
## Estimated group difference (Group 1 - Group 2):
##   0 [-0.0034, 0.0021]
## The relative frequency of success is larger for Group 1 by a probability
## of 0.4 and larger for Group 2 by a probability of 0.6 .</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb46-1"><a href="oftw_pregt.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-2"><a href="oftw_pregt.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#same with AB package</span></span>
<span id="cb46-3"><a href="oftw_pregt.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="oftw_pregt.html#cb46-4" aria-hidden="true" tabindex="-1"></a>empir_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;alpha&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_don_ss), <span class="st">&#39;beta&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(assigned_emails))</span>
<span id="cb46-5"><a href="oftw_pregt.html#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="oftw_pregt.html#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="oftw_pregt.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Bernoulli test</span></span>
<span id="cb46-8"><a href="oftw_pregt.html#cb46-8" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_all_AB <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb46-9"><a href="oftw_pregt.html#cb46-9" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_don_ss[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb46-10"><a href="oftw_pregt.html#cb46-10" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_don_ss[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb46-11"><a href="oftw_pregt.html#cb46-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> unif_prior,</span>
<span id="cb46-12"><a href="oftw_pregt.html#cb46-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb46-13"><a href="oftw_pregt.html#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="oftw_pregt.html#cb46-14" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_all_AB_empir <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb46-15"><a href="oftw_pregt.html#cb46-15" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_don_ss[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb46-16"><a href="oftw_pregt.html#cb46-16" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_don_ss[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb46-17"><a href="oftw_pregt.html#cb46-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> empir_prior,</span>
<span id="cb46-18"><a href="oftw_pregt.html#cb46-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb46-19"><a href="oftw_pregt.html#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="oftw_pregt.html#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_ss_by_treat_all_AB) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-11-2.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-11-3.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb47-1"><a href="oftw_pregt.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_ss_by_treat_all_AB_empir) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-4.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-11-5.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-11-6.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb48-1"><a href="oftw_pregt.html#cb48-1" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_all_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.9</span>)</span></code></div></pre></div>
<pre><code>## Quantiles of posteriors for A and B:
## 
## $Probability
## $Probability$A
##           0%          25%          50%          75%         100% 
## 0.0006591401 0.0034230099 0.0043367467 0.0053950450 0.0139389081 
## 
## $Probability$B
##           0%          25%          50%          75%         100% 
## 0.0008503472 0.0038631114 0.0048301295 0.0059442783 0.0137935894 
## 
## 
## --------------------------------------------
## 
## P(A &gt; B) by (0)%: 
## 
## $Probability
## [1] 0.40769
## 
## --------------------------------------------
## 
## Credible Interval on (A - B) / B for interval length(s) (0.9) : 
## 
## $Probability
##         5%        95% 
## -0.5874132  0.9230001 
## 
## --------------------------------------------
## 
## Posterior Expected Loss for choosing A over B:
## 
## $Probability
## [1] 0.3535216</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb50-1"><a href="oftw_pregt.html#cb50-1" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_all_AB_lift_int80 <span class="ot">&lt;-</span> don_ss_by_treat_all_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span>
<span id="cb50-2"><a href="oftw_pregt.html#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="oftw_pregt.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="oftw_pregt.html#cb50-4" aria-hidden="true" tabindex="-1"></a>don_ss_by_treat_all_AB_lift_int80_empir <span class="ot">&lt;-</span> don_ss_by_treat_all_AB_empir <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span></code></div></pre></div>
<p>80% credible intervals with the uniform prior for the ‘lift’ of Impact relative to Emotion are</p>
<p>-0.507, 0.621</p>
<p>and for the empirically informed (but symmetric prior):</p>
<p>-0.329, 0.379</p>
<p>Hard-coded: Here there is almost no evidence in either direction. However, our 80% credible intervals remain wide.</p>
<p><br />
</p>
<p>Unfortunately, this experiment proved to be underpowered, at least for the donation outcome.</p>
<p><strong>But what about clicks on the ‘donation link?’</strong> This could arguably be seen as a measure of ‘desire and intention to donate,’ and thus might be a more fine-grained and less noisy measure, improving our statistical power.</p>
<p>Some quick crosstabs (here as a share of <em>opens</em>)</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb51-1"><a href="oftw_pregt.html#cb51-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb51-2"><a href="oftw_pregt.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  donclick_by_treat <span class="ot">&lt;-</span>  oftw_mc_db <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="oftw_pregt.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(treat_emotion)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="oftw_pregt.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(treat_emotion, d_click_don_link) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="oftw_pregt.html#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_percentages</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="oftw_pregt.html#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="oftw_pregt.html#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_ns</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="oftw_pregt.html#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_title</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-9"><a href="oftw_pregt.html#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">caption =</span><span class="st">&quot;Click on donation link by treatment; all opened emails&quot;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb51-10"><a href="oftw_pregt.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;scale_down&quot;</span>)</span>
<span id="cb51-11"><a href="oftw_pregt.html#cb51-11" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<div class="table-container overflow-auto"><table class="table" class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-12">Table 1.1: </span>Click on donation link by treatment; all opened emails
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
d_click_don_link
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
treat_emotion
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
97.9% (1376)
</td>
<td style="text-align:left;">
2.1% (29)
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
95.3% (1134)
</td>
<td style="text-align:left;">
4.7% (56)
</td>
</tr>
</tbody>
</table></div>
<p>If this is our metric, it only seems fair to take into account ‘whether they opened the email’ as part of this effect. Thus, considering clicks as a share of <em>total emails sent</em>…</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb52-1"><a href="oftw_pregt.html#cb52-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb52-2"><a href="oftw_pregt.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  click_don_by_treat_opened_fit <span class="ot">&lt;-</span> <span class="fu">bayes.prop.test</span>(oc_mat_r<span class="sc">$</span>tot_d_click_don_link, assigned_emails,</span>
<span id="cb52-3"><a href="oftw_pregt.html#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cred.mass =</span> <span class="fl">0.95</span>) <span class="co"># 80% credible interval for decision-making purposes</span></span>
<span id="cb52-4"><a href="oftw_pregt.html#cb52-4" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<pre><code>## 
##  Bayesian First Aid proportion test
## 
## data: oc_mat_r$tot_d_click_don_link out of assigned_emails
## number of successes:    29,   56
## number of trials:     2000, 2000
## Estimated relative frequency of success [95% credible interval]:
##   Group 1: 0.015 [0.0098, 0.021]
##   Group 2: 0.028 [0.022, 0.036]
## Estimated group difference (Group 1 - Group 2):
##   -0.01 [-0.022, -0.0039]
## The relative frequency of success is larger for Group 1 by a probability
## of 0.001 and larger for Group 2 by a probability of 0.999 .</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb54-1"><a href="oftw_pregt.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(click_don_by_treat_opened_fit)</span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb55-1"><a href="oftw_pregt.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#same with AB  package</span></span>
<span id="cb55-2"><a href="oftw_pregt.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="oftw_pregt.html#cb55-3" aria-hidden="true" tabindex="-1"></a>empir_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;alpha&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(oc_mat_r<span class="sc">$</span>tot_d_click_don_link), <span class="st">&#39;beta&#39;</span> <span class="ot">=</span> <span class="fu">sum</span>(assigned_emails))</span>
<span id="cb55-4"><a href="oftw_pregt.html#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="oftw_pregt.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit bernoulli test</span></span>
<span id="cb55-6"><a href="oftw_pregt.html#cb55-6" aria-hidden="true" tabindex="-1"></a>don_click_by_treat_all_AB <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb55-7"><a href="oftw_pregt.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_click_don_link[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb55-8"><a href="oftw_pregt.html#cb55-8" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_click_don_link[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb55-9"><a href="oftw_pregt.html#cb55-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> unif_prior,</span>
<span id="cb55-10"><a href="oftw_pregt.html#cb55-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb55-11"><a href="oftw_pregt.html#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="oftw_pregt.html#cb55-12" aria-hidden="true" tabindex="-1"></a>don_click_by_treat_all_AB_empir <span class="ot">&lt;-</span> bayesAB<span class="sc">::</span><span class="fu">bayesTest</span>(</span>
<span id="cb55-13"><a href="oftw_pregt.html#cb55-13" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_click_don_link[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">0</span>],</span>
<span id="cb55-14"><a href="oftw_pregt.html#cb55-14" aria-hidden="true" tabindex="-1"></a>  oftw_mc_db_assigned<span class="sc">$</span>d_click_don_link[oftw_mc_db_assigned<span class="sc">$</span>treat_emotion<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb55-15"><a href="oftw_pregt.html#cb55-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">priors =</span> empir_prior,</span>
<span id="cb55-16"><a href="oftw_pregt.html#cb55-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&#39;bernoulli&#39;</span>)</span>
<span id="cb55-17"><a href="oftw_pregt.html#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="oftw_pregt.html#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_click_by_treat_all_AB) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-2.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-13-3.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-13-4.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb56-1"><a href="oftw_pregt.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(don_click_by_treat_all_AB_empir) </span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-5.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-13-6.png" width="80%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-13-7.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb57-1"><a href="oftw_pregt.html#cb57-1" aria-hidden="true" tabindex="-1"></a>don_click_by_treat_all_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.9</span>)</span></code></div></pre></div>
<pre><code>## Quantiles of posteriors for A and B:
## 
## $Probability
## $Probability$A
##          0%         25%         50%         75%        100% 
## 0.005594249 0.013065566 0.014804312 0.016725027 0.030814819 
## 
## $Probability$B
##         0%        25%        50%        75%       100% 
## 0.01450641 0.02590849 0.02833368 0.03088321 0.04743730 
## 
## 
## --------------------------------------------
## 
## P(A &gt; B) by (0)%: 
## 
## $Probability
## [1] 0.00159
## 
## --------------------------------------------
## 
## Credible Interval on (A - B) / B for interval length(s) (0.9) : 
## 
## $Probability
##         5%        95% 
## -0.6408927 -0.2465840 
## 
## --------------------------------------------
## 
## Posterior Expected Loss for choosing A over B:
## 
## $Probability
## [1] 0.9666799</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb59-1"><a href="oftw_pregt.html#cb59-1" aria-hidden="true" tabindex="-1"></a>don_click_by_treat_all_AB_lift_int80 <span class="ot">&lt;-</span> don_click_by_treat_all_AB <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span>
<span id="cb59-2"><a href="oftw_pregt.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="oftw_pregt.html#cb59-3" aria-hidden="true" tabindex="-1"></a>don_click_by_treat_all_AB_lift_int80_empir <span class="ot">&lt;-</span> don_click_by_treat_all_AB_empir <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">credInt=</span><span class="fl">0.8</span>)</span></code></div></pre></div>
<p>80% credible intervals with the uniform prior for the ‘lift’ of Impact relative to Emotion are</p>
<p>-0.610, -0.304</p>
<p>and for the empirically informed (but symmetric prior):</p>
<p>-0.3117, -0.0527</p>
<p>(Hard-coded)</p>
<p>There is fairly strong evidence that the emotion email lead to a higher rate of clicks on the donation link; note that this even is <em>in spite of</em> the lower rate of email opens.</p>
<p>This suggests (IMO) it is worth testing this further.</p>
</div>
<div id="redoing-a-bunch-of-stuff-manually" class="section level3" number="1.6.2">
<h3><span class="header-section-number">1.6.2</span> Redoing a bunch of stuff manually</h3>
<p>First, some building blocks;</p>
<p><em>the probability distribution over the absolute value of differences between two binomial random variables</em></p>
<p><strong>Adapting formulas from <a href="https://math.stackexchange.com/questions/562119/difference-of-two-binomial-random-variables">Stackexchange post</a> discussion</strong></p>
<p>Defining their code for this function:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb60-1"><a href="oftw_pregt.html#cb60-1" aria-hidden="true" tabindex="-1"></a>modBin <span class="ot">&lt;-</span> dbinom <span class="co">#DR: I just do this renaming here for consistency with the rest ... but the modBin they defined was redundant as it&#39;s already built ins</span></span>
<span id="cb60-2"><a href="oftw_pregt.html#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="oftw_pregt.html#cb60-3" aria-hidden="true" tabindex="-1"></a>diffBin <span class="ot">&lt;-</span> <span class="cf">function</span>(z, n1, p1, n2, p2){</span>
<span id="cb60-4"><a href="oftw_pregt.html#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="oftw_pregt.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb60-6"><a href="oftw_pregt.html#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="oftw_pregt.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (z<span class="sc">&gt;=</span><span class="dv">0</span>){</span>
<span id="cb60-8"><a href="oftw_pregt.html#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb60-9"><a href="oftw_pregt.html#cb60-9" aria-hidden="true" tabindex="-1"></a>      prob <span class="ot">&lt;-</span> prob <span class="sc">+</span> <span class="fu">modBin</span>(i<span class="sc">+</span>z, n1, p1) <span class="sc">*</span> <span class="fu">modBin</span>(i, n2, p2)</span>
<span id="cb60-10"><a href="oftw_pregt.html#cb60-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb60-11"><a href="oftw_pregt.html#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="oftw_pregt.html#cb60-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-13"><a href="oftw_pregt.html#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb60-14"><a href="oftw_pregt.html#cb60-14" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb60-15"><a href="oftw_pregt.html#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n2){</span>
<span id="cb60-16"><a href="oftw_pregt.html#cb60-16" aria-hidden="true" tabindex="-1"></a>      prob<span class="ot">&lt;-</span>prob<span class="sc">+</span><span class="fu">modBin</span>(i<span class="sc">+</span>z, n1, p1)<span class="sc">*</span><span class="fu">modBin</span>(i, n2, p2)</span>
<span id="cb60-17"><a href="oftw_pregt.html#cb60-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb60-18"><a href="oftw_pregt.html#cb60-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-19"><a href="oftw_pregt.html#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(prob)</span>
<span id="cb60-20"><a href="oftw_pregt.html#cb60-20" aria-hidden="true" tabindex="-1"></a>}</span></code></div></pre></div>
<p><br />
</p>
<p>We generate an alternate version to cover ‘differences in one direction,
i.e., but ’probability of observing (d1-d2)/(n1+n2) share more of d1 responses than d2 responses given sample sizes n1 and n2… over a range of true probabilities p1 and p2’</p>
<p><em>the probability distribution for differences between two binomial random variables in one direction</em></p>
<p>For the present case</p>
<p>Hard-coded notes…</p>
<p>::: {.foldable}</p>
<!-- Doing this from the (later: do from data) -->
<div class="sourceCode" id="cb61"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb61-1"><a href="oftw_pregt.html#cb61-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> oc_mat_r<span class="sc">$</span>tot_d_open[<span class="dv">1</span>]</span>
<span id="cb61-2"><a href="oftw_pregt.html#cb61-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> oc_mat_r<span class="sc">$</span>tot_d_open[<span class="dv">2</span>]</span>
<span id="cb61-3"><a href="oftw_pregt.html#cb61-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> oc_mat_r<span class="sc">$</span>tot_d_click_don_link[<span class="dv">1</span>]</span>
<span id="cb61-4"><a href="oftw_pregt.html#cb61-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> oc_mat_r<span class="sc">$</span>tot_d_click_don_link[<span class="dv">2</span>]</span>
<span id="cb61-5"><a href="oftw_pregt.html#cb61-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> d1<span class="sc">-</span>d2 <span class="co">#impact minus emotion</span></span></code></div></pre></div>
<p>Computation for a few ‘ad-hoc cases’ (later explore the space with vectors of values)</p>
<ol style="list-style-type: decimal">
<li>Suppose truly equal incidence, at the mean level</li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb62-1"><a href="oftw_pregt.html#cb62-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> (d1<span class="sc">+</span>d2)<span class="sc">/</span>(n1<span class="sc">+</span>n2)</span>
<span id="cb62-2"><a href="oftw_pregt.html#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="oftw_pregt.html#cb62-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1</span>
<span id="cb62-4"><a href="oftw_pregt.html#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="oftw_pregt.html#cb62-5" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb62-6"><a href="oftw_pregt.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  db_0 <span class="ot">&lt;-</span> <span class="fu">diffBin</span>(z, n1, p1, n2, p2)</span>
<span id="cb62-7"><a href="oftw_pregt.html#cb62-7" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<pre><code>## [1] 0.00003782046</code></pre>
<p>This implies there is a 0.00378% chance of getting this <em>exact</em> difference of +-27 incidence(s) between the treatments (in one direction), if the true incidence rates were equal.</p>
<p>Let’s plot this for a range of ‘incidence rate differences’ in this region. (Sorry, using the traditional plot, ggplot is better).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb64-1"><a href="oftw_pregt.html#cb64-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span><span class="sc">*</span>z, <span class="dv">10</span><span class="sc">*</span>z)</span>
<span id="cb64-2"><a href="oftw_pregt.html#cb64-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">sapply</span>(s, <span class="cf">function</span>(z) <span class="fu">diffBin</span>(z, n1, p1, n2, p2))</span>
<span id="cb64-3"><a href="oftw_pregt.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(s,p)</span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We see a large likelihood of values in the range of the +-27 difference observed, and a low likelihood of a difference of 10 or more in either direction.</p>
</div>
<div id="adaptation-of-this-magnitude-or-smaller" class="section level3" number="1.6.3">
<h3><span class="header-section-number">1.6.3</span> Adaptation: ‘of this magnitude or smaller’</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb65-1"><a href="oftw_pregt.html#cb65-1" aria-hidden="true" tabindex="-1"></a>ltmag_diffBin <span class="ot">&lt;-</span> <span class="cf">function</span>(z, n1, p1, n2, p2){</span>
<span id="cb65-2"><a href="oftw_pregt.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb65-3"><a href="oftw_pregt.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  z_n <span class="ot">&lt;-</span> <span class="sc">-</span>z <span class="co">#negative value</span></span>
<span id="cb65-4"><a href="oftw_pregt.html#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="oftw_pregt.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> z_n<span class="sc">:</span>z){     <span class="co">#sum for all integer differences between observed value and its negative, inclusive</span></span>
<span id="cb65-6"><a href="oftw_pregt.html#cb65-6" aria-hidden="true" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> prob <span class="sc">+</span> <span class="fu">diffBin</span>(i, n1, p1, n2, p2)</span>
<span id="cb65-7"><a href="oftw_pregt.html#cb65-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-8"><a href="oftw_pregt.html#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="oftw_pregt.html#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(prob)</span>
<span id="cb65-10"><a href="oftw_pregt.html#cb65-10" aria-hidden="true" tabindex="-1"></a>}</span></code></div></pre></div>
<p>Now, a similar computation as above, but for ‘a difference this big or smaller in magnitude’:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb66-1"><a href="oftw_pregt.html#cb66-1" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb66-2"><a href="oftw_pregt.html#cb66-2" aria-hidden="true" tabindex="-1"></a>    mag_db_0 <span class="ot">&lt;-</span> <span class="fu">ltmag_diffBin</span>(z, n1, p1, n2, p2)</span>
<span id="cb66-3"><a href="oftw_pregt.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  )</span></code></div></pre></div>
<pre><code>## [1] 0.9876964</code></pre>
<p>This implies there is a 98.8% chance of getting a difference <em>no larger than this one in magnitude</em> of +/–27 incidences between the treatments if the true incidence rates were equal.</p>
<p><br />
</p>
<p><strong>And finally, what we were looking for:</strong> the chance of ‘a difference this small or smaller’ as a function of the <strong>true difference…</strong></p>
<p>(Think about: should we do this for ‘a difference in the same direction’ instead?)</p>
<p>Set up an arbitrary vector of ‘true differences’ <!-- (to keep it simple, only change it in one direction for now ...) --></p>
<p>Below, I plot</p>
<p>Y-axis: ’how likely would be a difference in donations ‘as small or smaller in magnitude’” than we see in the data against…</p>
<p>X-axis: if the “true difference in incidence rates” were of these magnitudes</p>
<p>(Note: this should cover ‘a difference in either direction’; the probability of a difference in the direction we <em>do</em> see is obviously somewhat smaller)</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb68-1"><a href="oftw_pregt.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb68-2"><a href="oftw_pregt.html#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="oftw_pregt.html#cb68-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>)</span>
<span id="cb68-4"><a href="oftw_pregt.html#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="oftw_pregt.html#cb68-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">rep</span>((d1<span class="sc">+</span>d2)<span class="sc">/</span>(n1<span class="sc">+</span>n2), <span class="fu">length</span>(B))</span>
<span id="cb68-6"><a href="oftw_pregt.html#cb68-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1<span class="sc">*</span>B</span>
<span id="cb68-7"><a href="oftw_pregt.html#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="oftw_pregt.html#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="oftw_pregt.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="fu">as.list</span>(<span class="fu">ltmag_diffBin</span>(z, n1, p1, n2, p2)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">format</span>(<span class="at">digits=</span><span class="dv">3</span>, <span class="at">scientific=</span><span class="cn">FALSE</span>)</span></code></div></pre></div>
<pre><code>## [1] &quot;98.8&quot;   &quot;93.4&quot;   &quot;34.2&quot;   &quot;1.88&quot;   &quot;0.0167&quot;</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb70-1"><a href="oftw_pregt.html#cb70-1" aria-hidden="true" tabindex="-1"></a>probmag <span class="ot">&lt;-</span> <span class="fu">ltmag_diffBin</span>(z, n1, p1, n2, p2)</span>
<span id="cb70-2"><a href="oftw_pregt.html#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="oftw_pregt.html#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="oftw_pregt.html#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">#qplot(B, probmag, log  = &quot;x&quot;, xlab = &quot;True relative incidence&quot;, ylab =&quot;Prob. of difference this small&quot;)</span></span>
<span id="cb70-5"><a href="oftw_pregt.html#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="oftw_pregt.html#cb70-6" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb70-7"><a href="oftw_pregt.html#cb70-7" aria-hidden="true" tabindex="-1"></a>  probmag_plot <span class="ot">&lt;-</span></span>
<span id="cb70-8"><a href="oftw_pregt.html#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb70-9"><a href="oftw_pregt.html#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>B, <span class="at">y=</span>probmag) <span class="sc">+</span></span>
<span id="cb70-10"><a href="oftw_pregt.html#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-11"><a href="oftw_pregt.html#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log2&#39;</span>) <span class="sc">+</span></span>
<span id="cb70-12"><a href="oftw_pregt.html#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb70-13"><a href="oftw_pregt.html#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;True relative incidence rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb70-14"><a href="oftw_pregt.html#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Prob. diff. as small as obsd&quot;</span>)</span>
<span id="cb70-15"><a href="oftw_pregt.html#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="oftw_pregt.html#cb70-16" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Hard-coded takeaways 15 Dec 2021 :</p>
<p>Our data is consistent with ‘no difference’ (of course) … but its also consistent with ‘a fairly large difference in incidence’</p>
<p>E.g., even if one treatment truly lead to ‘twice as many donations as the other,’ we still have a 20% chance of seeing a differences as small as the one we see (of 8 versus 6)</p>
<p>We can reasonably ‘rule out’ differences of maybe 2.5x or greater</p>
<p>Main point: given the rareness of donations in this context, our sample size doesn’t let us make very strong conclusions in either directions … at least not yet. I hope that combined with other evidence, we will be able to infer more</p>
</div>
<div id="quick-redo-assuming-equal-shares-recieved-each-email-and-treating-email-reciepts-as-denom" class="section level3" number="1.6.4">
<h3><span class="header-section-number">1.6.4</span> Quick redo assuming equal shares recieved each email, and treating ‘email reciepts as denom’</h3>
<p>Approx 4000 total emails sent?</p>
<p>For squarespace</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb71-1"><a href="oftw_pregt.html#cb71-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb71-2"><a href="oftw_pregt.html#cb71-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb71-3"><a href="oftw_pregt.html#cb71-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb71-4"><a href="oftw_pregt.html#cb71-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb71-5"><a href="oftw_pregt.html#cb71-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> d1<span class="sc">-</span>d2</span>
<span id="cb71-6"><a href="oftw_pregt.html#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="oftw_pregt.html#cb71-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="fl">2.5</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>)</span>
<span id="cb71-8"><a href="oftw_pregt.html#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="oftw_pregt.html#cb71-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">rep</span>((d1<span class="sc">+</span>d2)<span class="sc">/</span>(n1<span class="sc">+</span>n2), <span class="fu">length</span>(B))</span>
<span id="cb71-10"><a href="oftw_pregt.html#cb71-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1<span class="sc">*</span>B</span>
<span id="cb71-11"><a href="oftw_pregt.html#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="oftw_pregt.html#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="oftw_pregt.html#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="oftw_pregt.html#cb71-14" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb71-15"><a href="oftw_pregt.html#cb71-15" aria-hidden="true" tabindex="-1"></a>    mag_db_0_ss <span class="ot">&lt;-</span> <span class="fu">ltmag_diffBin</span>(z, n1, p1, n2, p2)</span>
<span id="cb71-16"><a href="oftw_pregt.html#cb71-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></div></pre></div>
<pre><code>## [1] 0.071197896 0.100275616 0.147727269 0.220724651 0.272100392 0.154218060 0.046306831
## [8] 0.009174658 0.001345637</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb73-1"><a href="oftw_pregt.html#cb73-1" aria-hidden="true" tabindex="-1"></a>probmag_ss <span class="ot">&lt;-</span> <span class="fu">ltmag_diffBin</span>(z, n1, p1, n2, p2)</span>
<span id="cb73-2"><a href="oftw_pregt.html#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="oftw_pregt.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="oftw_pregt.html#cb73-4" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb73-5"><a href="oftw_pregt.html#cb73-5" aria-hidden="true" tabindex="-1"></a>  probmag_plot_ss <span class="ot">&lt;-</span></span>
<span id="cb73-6"><a href="oftw_pregt.html#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-7"><a href="oftw_pregt.html#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>B, <span class="at">y=</span>probmag_ss) <span class="sc">+</span></span>
<span id="cb73-8"><a href="oftw_pregt.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-9"><a href="oftw_pregt.html#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log2&#39;</span>) <span class="sc">+</span></span>
<span id="cb73-10"><a href="oftw_pregt.html#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>,.<span class="dv">51</span>) <span class="sc">+</span></span>
<span id="cb73-11"><a href="oftw_pregt.html#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;True relative incidence rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-12"><a href="oftw_pregt.html#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Prob. diff. as small as obsd&quot;</span>)</span>
<span id="cb73-13"><a href="oftw_pregt.html#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="oftw_pregt.html#cb73-14" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb74-1"><a href="oftw_pregt.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#note that it is not symmetric bc (I think) a very low incidence on one side makes particular large observed proportional differences more likely</span></span></code></div></pre></div>
<p>For all one-time donations</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb75-1"><a href="oftw_pregt.html#cb75-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb75-2"><a href="oftw_pregt.html#cb75-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb75-3"><a href="oftw_pregt.html#cb75-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb75-4"><a href="oftw_pregt.html#cb75-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb75-5"><a href="oftw_pregt.html#cb75-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> d1<span class="sc">-</span>d2</span>
<span id="cb75-6"><a href="oftw_pregt.html#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="oftw_pregt.html#cb75-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="fl">2.5</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>)</span>
<span id="cb75-8"><a href="oftw_pregt.html#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="oftw_pregt.html#cb75-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">rep</span>((d1<span class="sc">+</span>d2)<span class="sc">/</span>(n1<span class="sc">+</span>n2), <span class="fu">length</span>(B))</span>
<span id="cb75-10"><a href="oftw_pregt.html#cb75-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1<span class="sc">*</span>B</span>
<span id="cb75-11"><a href="oftw_pregt.html#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="oftw_pregt.html#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="oftw_pregt.html#cb75-13" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb75-14"><a href="oftw_pregt.html#cb75-14" aria-hidden="true" tabindex="-1"></a>    mag_db_0 <span class="ot">&lt;-</span> <span class="fu">ltmag_diffBin</span>(z, n1, p1, n2, p2)</span>
<span id="cb75-15"><a href="oftw_pregt.html#cb75-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></div></pre></div>
<pre><code>## [1] 0.0922168538 0.1395427545 0.2249330548 0.3745240308 0.5032003013 0.2505329859
## [7] 0.0521354769 0.0059810731 0.0004413855</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r collapse"><div><code class="sourceCode r"><span id="cb77-1"><a href="oftw_pregt.html#cb77-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb77-2"><a href="oftw_pregt.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  probmag_plot_ot <span class="ot">&lt;-</span></span>
<span id="cb77-3"><a href="oftw_pregt.html#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="oftw_pregt.html#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>B, <span class="at">y=</span>probmag) <span class="sc">+</span></span>
<span id="cb77-5"><a href="oftw_pregt.html#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-6"><a href="oftw_pregt.html#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log2&#39;</span>) <span class="sc">+</span></span>
<span id="cb77-7"><a href="oftw_pregt.html#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>,.<span class="dv">51</span>) <span class="sc">+</span></span>
<span id="cb77-8"><a href="oftw_pregt.html#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;True relative incidence rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-9"><a href="oftw_pregt.html#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Prob. diff. as small as obsd&quot;</span>)</span>
<span id="cb77-10"><a href="oftw_pregt.html#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="oftw_pregt.html#cb77-11" aria-hidden="true" tabindex="-1"></a>)</span></code></div></pre></div>
<pre><code>## Error in `check_aesthetics()`:
## ! Aesthetics must be either length 1 or the same as the data (9): y</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="demographics-and-interactions-to-do" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Demographics and interactions (to do)</h2>

</div>
</div>







<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Todo – more direct input through API tools; package bigrquery for bitquery.<a href="oftw_pregt.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>We could and should do a great deal of this. We should present the results relevant to this trial in specific here. Elsewhere we can do a deeper dive into OftW data in a general sense.<a href="oftw_pregt.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<div class="text-center m-5">
<a href="index.html"><button class="btn btn-secondary">Previous</button></a>

</div>
</main>
</div>
</div>


</div>

<!-- Bootstrap Bundle with Popper -->
<script 
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" 
  integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" 
  crossorigin="anonymous">
</script>

<!-- Littlefoot -->
<script
  src="https://unpkg.com/littlefoot/dist/littlefoot.js"
  type="application/javascript"
></script>
<script type="application/javascript">
  littlefoot.littlefoot() // Pass any littlefoot settings here.
</script>

<script>
// Set the current page to be active in the TOC
const id = document.getElementsByClassName("level1").item(0).id
const item = document.getElementById("item-" + id)
item.classList.toggle("active")

// Add foldable sections
const foldables = document.getElementsByClassName("foldable")

for (foldable of foldables) {
  const a = foldable.firstChild
  
  a.href = "#"
  a.onclick = function() {

    if (this.innerHTML === "Show") {
      this.innerHTML = "Hide"
    } else {
      this.innerHTML = "Show"
    }
    
    const bsCollapse = new bootstrap.Collapse(a.nextSibling, {
      toggle: true
    })
  }
}

</script>

<script>
// Create toggle code function
toggleCode = function() {
  const mainContainer = document.getElementById("main-container")
  const codes = mainContainer.getElementsByClassName('sourceCode r collapse')
  
  for (code of codes) {
    new bootstrap.Collapse(code, {toggle: true})
  }
}

// Add sidebar toggle functionality
window.addEventListener('DOMContentLoaded', event => {
  // Toggle the side navigation
  const sidebarToggle = document.body.querySelector('#sidebarToggle');
  if (sidebarToggle) {
    
    if (localStorage.getItem('sb|sidebar-toggle') === 'true') {
      document.body.classList.toggle('sb-sidenav-toggled');
    }
    sidebarToggle.addEventListener('click', event => {
      event.preventDefault();
      document.body.classList.toggle('sb-sidenav-toggled');
      localStorage.setItem(
        'sb|sidebar-toggle', 
        document.body.classList.contains('sb-sidenav-toggled')
      );
    });
  }
  
  // Add toggle code function to toggle code button
  const toggleCodeButton = document.getElementById("toggleCodeButton")
  toggleCodeButton.onclick = toggleCode
});
</script>

</body>
</html>
